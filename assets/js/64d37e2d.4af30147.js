"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[37615],{48095:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>c,contentTitle:()=>n,default:()=>l,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var i=o(85893),t=o(11151);const a={title:"Coordinator Mirroring Overview"},n="Coordinator Mirroring Overview",s={id:"sys-admin/high-availability/coordinator-mirroring-overview",title:"Coordinator Mirroring Overview",description:"You can deploy a backup or mirror of the coordinator instance on a separate host machine. The backup coordinator instance, called the standby coordinator, serves as a warm standby if the primary coordinator becomes nonoperational. You create a standby coordinator from the primary coordinator while the primary is online.",source:"@site/docs/sys-admin/high-availability/coordinator-mirroring-overview.md",sourceDirName:"sys-admin/high-availability",slug:"/sys-admin/high-availability/coordinator-mirroring-overview",permalink:"/docs/next/sys-admin/high-availability/coordinator-mirroring-overview",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/docs/sys-admin/high-availability/coordinator-mirroring-overview.md",tags:[],version:"current",lastUpdatedBy:"Dianjin Wang",lastUpdatedAt:1766576493,formattedLastUpdatedAt:"Dec 24, 2025",frontMatter:{title:"Coordinator Mirroring Overview"},sidebar:"docsbars",previous:{title:"Segment Mirroring Overview",permalink:"/docs/next/sys-admin/high-availability/segment-mirroring-overview"},next:{title:"Enable Mirroring",permalink:"/docs/next/sys-admin/high-availability/enable-mirroring"}},c={},d=[];function h(e){const r={a:"a",code:"code",em:"em",h1:"h1",img:"img",li:"li",p:"p",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h1,{id:"coordinator-mirroring-overview",children:"Coordinator Mirroring Overview"}),"\n",(0,i.jsxs)(r.p,{children:["You can deploy a backup or mirror of the coordinator instance on a separate host machine. The backup coordinator instance, called the ",(0,i.jsx)(r.em,{children:"standby coordinator"}),", serves as a warm standby if the primary coordinator becomes nonoperational. You create a standby coordinator from the primary coordinator while the primary is online."]}),"\n",(0,i.jsxs)(r.p,{children:["When you enable coordinator mirroring for an existing system, the primary coordinator continues to provide service to users while a snapshot of the primary coordinator instance is taken. While the snapshot is taken and deployed on the standby coordinator, changes to the primary coordinator are also recorded. After the snapshot has been deployed on the standby coordinator, the standby coordinator is synchronized and kept current using Write-Ahead Logging (WAL)-based streaming replication. Apache Cloudberry WAL replication uses the ",(0,i.jsx)(r.code,{children:"walsender"})," and ",(0,i.jsx)(r.code,{children:"walreceiver"})," replication processes. The ",(0,i.jsx)(r.code,{children:"walsender"})," process is a primary coordinator process. The ",(0,i.jsx)(r.code,{children:"walreceiver"})," is a standby coordinator process."]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.img,{alt:"Coordinator Mirroring in Apache Cloudberry",src:o(9408).Z+"",width:"463",height:"283"})}),"\n",(0,i.jsx)(r.p,{children:"Because the coordinator does not house user data, only system catalog tables are synchronized between the primary and standby coordinators. When these tables are updated, the replication logs that capture the changes are streamed to the standby coordinator to keep it current with the primary. During WAL replication, all database modifications are written to replication logs before being applied, to ensure data integrity for any in-process operations."}),"\n",(0,i.jsx)(r.p,{children:"This is how Apache Cloudberry handles a coordinator failure."}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["If the primary coordinator fails, the Apache Cloudberry system shuts down and the coordinator replication process stops. The administrator runs the ",(0,i.jsx)(r.code,{children:"gpactivatestandby"})," utility to have the standby coordinator take over as the new primary coordinator. Upon activation of the standby coordinator, the replicated logs reconstruct the state of the primary coordinator at the time of the last successfully committed transaction. The activated standby coordinator then functions as the Apache Cloudberry coordinator, accepting connections on the port specified when standby coordinator was initialized. See ",(0,i.jsx)(r.a,{href:"/docs/next/sys-admin/high-availability/recover-a-failed-coordinator",children:"Recovering a Failed Coordinator"}),"."]}),"\n",(0,i.jsx)(r.li,{children:"If the standby coordinator fails or becomes inaccessible while the primary coordinator is active, the primary coordinator tracks database changes in logs that are applied to the standby coordinator when it is recovered."}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"These Apache Cloudberry system catalog tables contain mirroring and replication information."}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["The catalog table ",(0,i.jsx)(r.a,{href:"/docs/next/sys-catalogs/sys-tables/gp-segment-configuration",children:(0,i.jsx)(r.code,{children:"gp_segment_configuration"})})," contains the current configuration and state of primary and mirror segment instances and the coordinator and standby coordinator instance."]}),"\n",(0,i.jsxs)(r.li,{children:["The catalog view ",(0,i.jsx)(r.code,{children:"gp_stat_replication"})," contains replication statistics of the ",(0,i.jsx)(r.code,{children:"walsender"})," processes that are used for Apache Cloudberry coordinator and segment mirroring."]}),"\n"]})]})}function l(e={}){const{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},9408:(e,r,o)=>{o.d(r,{Z:()=>i});const i=o.p+"assets/images/coordinator-mirror-7bb95c1671c8096903aab4700e7978da.png"},11151:(e,r,o)=>{o.d(r,{Z:()=>s,a:()=>n});var i=o(67294);const t={},a=i.createContext(t);function n(e){const r=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:n(e.components),i.createElement(a.Provider,{value:r},e.children)}}}]);