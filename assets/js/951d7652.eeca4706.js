"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[87839],{41990:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});var i=s(85893),r=s(11151);const l={title:"On Rocky Linux 9"},t="Compile and Install Apache Cloudberry on Rocky Linux 9",o={id:"cbdb-rockylinux9-compile",title:"On Rocky Linux 9",description:"The source of this document is from Building Apache Cloudberry (Incubating): A Development Environment Guide.",source:"@site/versioned_docs/version-1.x/cbdb-rockylinux9-compile.md",sourceDirName:".",slug:"/cbdb-rockylinux9-compile",permalink:"/docs/1.x/cbdb-rockylinux9-compile",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/versioned_docs/version-1.x/cbdb-rockylinux9-compile.md",tags:[],version:"1.x",lastUpdatedBy:"GEV00",lastUpdatedAt:1754448784,formattedLastUpdatedAt:"Aug 6, 2025",frontMatter:{title:"On Rocky Linux 9"},sidebar:"docsbars",previous:{title:"On Rocky Linux 8 and Ubuntu",permalink:"/docs/1.x/cbdb-rockylinux8-ubuntu-compile"},next:{title:"Software and Hardware Configuration",permalink:"/docs/1.x/cbdb-op-software-hardware"}},d={},a=[{value:"1. Target audience",id:"1-target-audience",level:2},{value:"2. Process of building Apache Cloudberry",id:"2-process-of-building-apache-cloudberry",level:2},{value:"3. Key differences between Cloudberry and PostgreSQL",id:"3-key-differences-between-cloudberry-and-postgresql",level:2},{value:"4. Prerequisites",id:"4-prerequisites",level:2},{value:"4.1 Provision a Rocky Linux 9 VM",id:"41-provision-a-rocky-linux-9-vm",level:3},{value:"4.2 System requirements",id:"42-system-requirements",level:3},{value:"4.3 Install <code>sudo</code> (if missing)",id:"43-install-sudo-if-missing",level:3},{value:"4.4 Install required packages",id:"44-install-required-packages",level:3},{value:"4.4.1 Install basic system packages",id:"441-install-basic-system-packages",level:4},{value:"4.4.2 Install CodeReady Builder (CRB) packages",id:"442-install-codeready-builder-crb-packages",level:4},{value:"4.5 Create and configure the &#39;gpadmin&#39; user",id:"45-create-and-configure-the-gpadmin-user",level:3},{value:"4.5.1 Set up the gpadmin user environment",id:"451-set-up-the-gpadmin-user-environment",level:4},{value:"4.5.2 Required configuration",id:"452-required-configuration",level:4},{value:"4.6 Configure system settings",id:"46-configure-system-settings",level:3},{value:"5. Retrieve and compile software",id:"5-retrieve-and-compile-software",level:2},{value:"5.1 Download, build, and install Apache Xerces-C",id:"51-download-build-and-install-apache-xerces-c",level:3},{value:"5.1.1 Set variables (helper)",id:"511-set-variables-helper",level:4},{value:"5.1.2 Download and verify the source package",id:"512-download-and-verify-the-source-package",level:4},{value:"5.1.3 Extract, configure, build, test, and install",id:"513-extract-configure-build-test-and-install",level:4},{value:"5.2 Clone the Apache Cloudberry repository",id:"52-clone-the-apache-cloudberry-repository",level:3},{value:"5.3 Configure the build process",id:"53-configure-the-build-process",level:3},{value:"5.3.1 Prepare environment",id:"531-prepare-environment",level:4},{value:"5.3.2 Run <code>configure</code>",id:"532-run-configure",level:4},{value:"5.4 Build and install Apache Cloudberry and contrib extensions",id:"54-build-and-install-apache-cloudberry-and-contrib-extensions",level:3},{value:"5.4.1 Compile the code",id:"541-compile-the-code",level:4},{value:"5.4.2 Install the compiled binaries",id:"542-install-the-compiled-binaries",level:4},{value:"5.5 Verify installation",id:"55-verify-installation",level:3},{value:"5.5.1 Check Cloudberry version",id:"551-check-cloudberry-version",level:4},{value:"5.5.2 Verify library dependencies",id:"552-verify-library-dependencies",level:4},{value:"5.5.3 Check library extensions",id:"553-check-library-extensions",level:4},{value:"5.5.4 Check core utilities",id:"554-check-core-utilities",level:4},{value:"5.6 Common issues",id:"56-common-issues",level:3},{value:"6. Set up a Cloudberry development cluster",id:"6-set-up-a-cloudberry-development-cluster",level:2},{value:"6.1 Set up initial container (not required for all environments)",id:"61-set-up-initial-container-not-required-for-all-environments",level:3},{value:"6.2 Configure SSH for Cloudberry",id:"62-configure-ssh-for-cloudberry",level:3},{value:"6.3 Set up Cloudberry environment variables",id:"63-set-up-cloudberry-environment-variables",level:3},{value:"6.4 Create development cluster",id:"64-create-development-cluster",level:3},{value:"6.5 Configure cluster environment",id:"65-configure-cluster-environment",level:3},{value:"6.6 Validate cluster deployment",id:"66-validate-cluster-deployment",level:3},{value:"6.7 Extension Testing Example: pg_stat_statements",id:"67-extension-testing-example-pg_stat_statements",level:3},{value:"6.8 Destroy development cluster",id:"68-destroy-development-cluster",level:3},{value:"6.9 Troubleshoot SSH connection issues",id:"69-troubleshoot-ssh-connection-issues",level:3},{value:"7. Validate basic functionalities",id:"7-validate-basic-functionalities",level:2},{value:"7.1 Test results",id:"71-test-results",level:3},{value:"7.2 Troubleshoot test failures",id:"72-troubleshoot-test-failures",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"compile-and-install-apache-cloudberry-on-rocky-linux-9",children:"Compile and Install Apache Cloudberry on Rocky Linux 9"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["The source of this document is from ",(0,i.jsx)(n.a,{href:"https://github.com/edespino/cloudberry/blob/rocky9-dev-readme/deploy/build/README-rockylinux9.md",children:"Building Apache Cloudberry (Incubating): A Development Environment Guide"}),"."]})}),"\n",(0,i.jsx)(n.p,{children:"This document is intended for developers interested in exploring and potentially contributing to Apache Cloudberry. The build environment described here is optimized for development and testing purposes only."}),"\n",(0,i.jsxs)(n.p,{children:["To learn how to compile and install Apache Cloudberry on Rocky Linux 8 and Ubuntu, see ",(0,i.jsx)(n.a,{href:"/docs/cbdb-rockylinux8-ubuntu-compile.md",children:"Compile on Rocky Linux 8 and Ubuntu"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"1-target-audience",children:"1. Target audience"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Developers interested in contributing to Apache Cloudberry."}),"\n",(0,i.jsx)(n.li,{children:"PostgreSQL developers wanting to explore Cloudberry's extensions."}),"\n",(0,i.jsx)(n.li,{children:"Database enthusiasts interested in learning about distributed query processing."}),"\n",(0,i.jsx)(n.li,{children:"Anyone considering joining the Apache Cloudberry community."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The build process described here enables development activities such as:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Debugging and testing new features."}),"\n",(0,i.jsx)(n.li,{children:"Exploring the codebase with development tools."}),"\n",(0,i.jsx)(n.li,{children:"Running test suites and validation checks."}),"\n",(0,i.jsx)(n.li,{children:"Making and testing code modifications."}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"If you are new to Apache Cloudberry or PostgreSQL development:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consider building PostgreSQL first to understand the basic workflow"}),"\n",(0,i.jsx)(n.li,{children:"Join the project's mailing lists to connect with other developers"}),"\n",(0,i.jsx)(n.li,{children:"Review the project's issue tracker to understand current development priorities"}),"\n",(0,i.jsx)(n.li,{children:"Be prepared for longer build times and iterative testing as you explore the codebase"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"2-process-of-building-apache-cloudberry",children:"2. Process of building Apache Cloudberry"}),"\n",(0,i.jsx)(n.p,{children:"The build process for Apache Cloudberry (Incubating) closely resembles that of PostgreSQL. If you have previously set up development environments for PostgreSQL, you'll find the steps for Cloudberry very familiar."}),"\n",(0,i.jsx)(n.p,{children:"For those new to Cloudberry or PostgreSQL, I recommend starting with a PostgreSQL build first. The PostgreSQL development community has established excellent documentation and tooling to guide you through the process. Familiarizing yourself with PostgreSQL's build process will make transitioning to Cloudberry significantly easier."}),"\n",(0,i.jsx)(n.h2,{id:"3-key-differences-between-cloudberry-and-postgresql",children:"3. Key differences between Cloudberry and PostgreSQL"}),"\n",(0,i.jsx)(n.p,{children:"While the overall process is similar, there are a few additional considerations when working with Cloudberry due to its distributed architecture:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extra Dependencies"}),": Certain libraries and tools are required, such as ",(0,i.jsx)(n.code,{children:"xerces-c"})," for the Orca query optimizer."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Distributed Nature"}),": Cloudberry builds on PostgreSQL to support massively parallel processing, which introduces extra configuration steps."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Once you are familiar with PostgreSQL, setting up Cloudberry will be straightforward. The following sections will guide you through the build and runtime setup process for Cloudberry."}),"\n",(0,i.jsx)(n.h2,{id:"4-prerequisites",children:"4. Prerequisites"}),"\n",(0,i.jsx)(n.h3,{id:"41-provision-a-rocky-linux-9-vm",children:"4.1 Provision a Rocky Linux 9 VM"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use any platform to create a virtual machine or container:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"AWS EC2"}),": These instructions were validated using the Rocky-9-EC2-Base-9.5-20241118.0.x86_64 AMI, but should work with any Rocky Linux 9 variant."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"VirtualBox"}),": Use the official Rocky Linux 9 ISO or Vagrant boxes."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Docker"}),": These instructions were validated using ",(0,i.jsx)(n.code,{children:"rockylinux/rockylinux:9"}),", but should work with any Rocky Linux 9 based container."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -it --shm-size=2gb -h cdw rockylinux/rockylinux:9\n"})}),"\n",(0,i.jsx)(n.p,{children:"The hostname 'cdw' (Coordinator Data Warehouse) is just an example of how we started the container for testing."}),"\n",(0,i.jsxs)(n.p,{children:["To ensure test suites run successfully, you may need to increase the container's shared memory using ",(0,i.jsx)(n.code,{children:"--shm-size=2gb"}),". Test failures can occur when the Cloudberry cluster lacks sufficient shared memory resources."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Other cloud platforms"}),": Use an equivalent Rocky Linux 9 image."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Ensure the VM or container has:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Internet connectivity for package installation."}),"\n",(0,i.jsx)(n.li,{children:"SSH or console access for user interaction."}),"\n",(0,i.jsx)(n.li,{children:"Sufficient resources (CPU, memory, and storage) for a development environment."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Specific steps to provision the environment are not covered in this guide because they vary by platforms. This guide assumes you have successfully created a VM or container and can log in as the default user (for example, ",(0,i.jsx)(n.code,{children:"rocky"})," for Rocky Linux on AWS)."]})}),"\n",(0,i.jsx)(n.h3,{id:"42-system-requirements",children:"4.2 System requirements"}),"\n",(0,i.jsx)(n.p,{children:"Minimum requirements for development environment:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CPU: 4 cores recommended (2 cores minimum)"}),"\n",(0,i.jsx)(n.li,{children:"RAM: 8GB recommended (4GB minimum)"}),"\n",(0,i.jsx)(n.li,{children:"Storage: 20GB free space recommended"}),"\n",(0,i.jsx)(n.li,{children:"Network: Broadband internet connection for package downloads"}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"43-install-sudo-if-missing",children:["4.3 Install ",(0,i.jsx)(n.code,{children:"sudo"})," (if missing)"]}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"sudo"})," is not already installed, run the following command to install it:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"dnf install -y sudo\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["In environments like Docker, the ",(0,i.jsx)(n.code,{children:"root"})," user will be able to use ",(0,i.jsx)(n.code,{children:"sudo"})," without a password prompt once it is installed."]})}),"\n",(0,i.jsx)(n.h3,{id:"44-install-required-packages",children:"4.4 Install required packages"}),"\n",(0,i.jsx)(n.p,{children:"This step installs essential development tools, libraries, and dependencies required for building Apache Cloudberry."}),"\n",(0,i.jsx)(n.h4,{id:"441-install-basic-system-packages",children:"4.4.1 Install basic system packages"}),"\n",(0,i.jsx)(n.p,{children:"The following command installs the primary packages required for Cloudberry development:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo dnf install -y apr-devel autoconf bison bzip2 bzip2-devel cmake3 createrepo_c ed flex gcc gcc-c++ git glibc-langpack-en initscripts iproute java-11-openjdk java-11-openjdk-devel krb5-devel less libcurl-devel libevent-devel libuuid-devel libxml2-devel libzstd-devel lz4 lz4-devel m4 nc net-tools openldap-devel openssh-clients openssh-server openssl-devel pam-devel passwd perl perl-Env perl-ExtUtils-Embed perl-Test-Simple perl-core pinentry python3-devel python3-lxml python3-psutil python3-pytest python3-pyyaml readline-devel rpm-build rpm-sign rpmdevtools rsync tar unzip util-linux-ng wget which zlib-devel\n"})}),"\n",(0,i.jsx)(n.h4,{id:"442-install-codeready-builder-crb-packages",children:"4.4.2 Install CodeReady Builder (CRB) packages"}),"\n",(0,i.jsx)(n.p,{children:"The CRB repository provides additional development tools and libraries. On Rocky Linux, this repository is disabled by default and must be explicitly enabled."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo dnf install -y --enablerepo=crb libuv-devel libyaml-devel perl-IPC-Run\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:'In Red Hat Enterprise Linux (RHEL), this repository is called "PowerTools."'})}),"\n",(0,i.jsx)(n.h3,{id:"45-create-and-configure-the-gpadmin-user",children:"4.5 Create and configure the 'gpadmin' user"}),"\n",(0,i.jsxs)(n.p,{children:["To prepare the environment for Apache Cloudberry (Incubating) development, we need to create and configure a dedicated ",(0,i.jsx)(n.code,{children:"gpadmin"})," user."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a user 'gpadmin' with matching group, home directory, and bash shell:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo useradd -U -m -s /bin/bash gpadmin\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Grant password-less sudo access to ",(0,i.jsx)(n.code,{children:"gpadmin"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo 'gpadmin ALL=(ALL) NOPASSWD:ALL' | sudo tee /etc/sudoers.d/90-gpadmin\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Verify the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user setup:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo -u gpadmin sudo whoami\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If the output is ",(0,i.jsx)(n.code,{children:"root"}),", the configuration is correct."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"451-set-up-the-gpadmin-user-environment",children:"4.5.1 Set up the gpadmin user environment"}),"\n",(0,i.jsx)(n.p,{children:"Optional steps to enhance gpadmin's development environment with Vim, Tmux, and Oh My Bash configurations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo dnf install -y vim tmux\n\nsudo -u gpadmin bash <<'EOF'\n# Set up Vim configuration\nwget -nv -q https://gist.githubusercontent.com/simonista/8703722/raw/d08f2b4dc10452b97d3ca15386e9eed457a53c61/.vimrc -O /home/gpadmin/.vimrc\n\n# Set up Tmux configuration\nwget -nv -q https://raw.githubusercontent.com/tony/tmux-config/master/.tmux.conf -O /home/gpadmin/.tmux.conf\n\n# Install Oh My Bash\nbash -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmybash/oh-my-bash/master/tools/install.sh)\" --unattended\nEOF\n"})}),"\n",(0,i.jsx)(n.h4,{id:"452-required-configuration",children:"4.5.2 Required configuration"}),"\n",(0,i.jsxs)(n.p,{children:["This script performs three main tasks as the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Updates .bashrc to source Cloudberry environment variables"}),"\n",(0,i.jsx)(n.li,{children:"Sets up SSH key pair for passwordless login (if not already present)"}),"\n",(0,i.jsx)(n.li,{children:"Configures proper SSH directory permissions for security"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The script uses a heredoc (EOF) block to execute multiple commands under the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user context. This will be used multiple time throughout these instructions."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo -u gpadmin bash <<'EOF'\n# Add Cloudberry environment setup to .bashrc\necho -e '\\n# Add Cloudberry entries\nif [ -f /usr/local/cloudberry-db/greenplum_path.sh ]; then\n  source /usr/local/cloudberry-db/greenplum_path.sh\nfi\n\n# US English with UTF-8 character encoding\nexport LANG=en_US.UTF-8\n' >> /home/gpadmin/.bashrc\n\n# Set up SSH for passwordless access\nmkdir -p /home/gpadmin/.ssh\nif [ ! -f /home/gpadmin/.ssh/id_rsa ]; then\n  ssh-keygen -t rsa -b 2048 -C 'apache-cloudberry-dev' -f /home/gpadmin/.ssh/id_rsa -N \"\"\nfi\ncat /home/gpadmin/.ssh/id_rsa.pub >> /home/gpadmin/.ssh/authorized_keys\n\n# Set proper SSH directory permissions\nchmod 700 /home/gpadmin/.ssh\nchmod 600 /home/gpadmin/.ssh/authorized_keys\nchmod 644 /home/gpadmin/.ssh/id_rsa.pub\nEOF\n"})}),"\n",(0,i.jsx)(n.h3,{id:"46-configure-system-settings",children:"4.6 Configure system settings"}),"\n",(0,i.jsxs)(n.p,{children:["Database systems like Apache Cloudberry require specific system resource limits to operate efficiently. These limits should be configured for the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user who runs the database processes."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create resource limits configuration"}),"\n",(0,i.jsx)(n.p,{children:"Create user limits configuration file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo tee /etc/security/limits.d/90-db-limits.conf << 'EOF'\n# Core dump file size limits for gpadmin\ngpadmin soft core unlimited\ngpadmin hard core unlimited\n# Open file limits for gpadmin\ngpadmin soft nofile 524288\ngpadmin hard nofile 524288\n# Process limits for gpadmin\ngpadmin soft nproc 131072\ngpadmin hard nproc 131072\nEOF\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Understand the limits."}),"\n",(0,i.jsx)(n.p,{children:"The configuration sets the following types of resource limits:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Core Dumps"})," (",(0,i.jsx)(n.code,{children:"core"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Set to ",(0,i.jsx)(n.code,{children:"unlimited"})," to enable complete core dumps"]}),"\n",(0,i.jsx)(n.li,{children:"Essential for debugging and troubleshooting"}),"\n",(0,i.jsx)(n.li,{children:"Both soft and hard limits are unrestricted"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Open Files"})," (",(0,i.jsx)(n.code,{children:"nofile"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Set to ",(0,i.jsx)(n.code,{children:"524288"})," (512K) files"]}),"\n",(0,i.jsx)(n.li,{children:"Required for handling many concurrent database connections"}),"\n",(0,i.jsx)(n.li,{children:"Critical for distributed operations and large workloads"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Process Limits"})," (",(0,i.jsx)(n.code,{children:"nproc"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Set to ",(0,i.jsx)(n.code,{children:"131072"})," (128K) processes"]}),"\n",(0,i.jsx)(n.li,{children:"Enables parallel query execution"}),"\n",(0,i.jsx)(n.li,{children:"Supports Cloudberry's distributed architecture"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify resource limits."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check current limits\nsudo -u gpadmin ulimit -a\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"5-retrieve-and-compile-software",children:"5. Retrieve and compile software"}),"\n",(0,i.jsxs)(n.p,{children:["From here on out we execute commands as the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo su - gpadmin\n"})}),"\n",(0,i.jsx)(n.h3,{id:"51-download-build-and-install-apache-xerces-c",children:"5.1 Download, build, and install Apache Xerces-C"}),"\n",(0,i.jsx)(n.p,{children:"Apache Xerces-C is a required dependency for enabling the Orca query optimizer in Cloudberry. The following steps download the source code, verify its integrity, build the library, and install it."}),"\n",(0,i.jsx)(n.h4,{id:"511-set-variables-helper",children:"5.1.1 Set variables (helper)"}),"\n",(0,i.jsx)(n.p,{children:"To streamline the commands and make them reusable, define the following helper variables:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'XERCES_LATEST_RELEASE=3.3.0\nXERCES_INSTALL_PREFIX="/usr/local/xerces-c"\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"These variables are used throughout the build process to specify the version of Apache Xerces-C being installed (XERCES_LATEST_RELEASE) and its installation directory (XERCES_INSTALL_PREFIX). This ensures consistency and simplifies the commands."})}),"\n",(0,i.jsx)(n.h4,{id:"512-download-and-verify-the-source-package",children:"5.1.2 Download and verify the source package"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'wget -nv "https://dlcdn.apache.org//xerces/c/3/sources/xerces-c-${XERCES_LATEST_RELEASE}.tar.gz"\necho "$(curl -sL https://dlcdn.apache.org//xerces/c/3/sources/xerces-c-${XERCES_LATEST_RELEASE}.tar.gz.sha256)" | sha256sum -c -\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Ensure the SHA-256 checksum validation passes (output: ",(0,i.jsx)(n.code,{children:"xerces-c-3.3.0.tar.gz: OK"}),"). If it fails, do not proceed and verify the source package's integrity."]})}),"\n",(0,i.jsx)(n.h4,{id:"513-extract-configure-build-test-and-install",children:"5.1.3 Extract, configure, build, test, and install"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'tar xf "xerces-c-${XERCES_LATEST_RELEASE}.tar.gz"\nrm "xerces-c-${XERCES_LATEST_RELEASE}.tar.gz"\ncd xerces-c-${XERCES_LATEST_RELEASE}\n\n./configure --prefix="${XERCES_INSTALL_PREFIX}-${XERCES_LATEST_RELEASE}" | tee configure-$(date "+%Y.%m.%d-%H.%M.%S").log\nmake -j$(nproc) | tee make-$(date "+%Y.%m.%d-%H.%M.%S").log\nmake check | tee make-check-$(date "+%Y.%m.%d-%H.%M.%S").log\nsudo make install | tee make-install-$(date "+%Y.%m.%d-%H.%M.%S").log\nsudo ln -s ${XERCES_INSTALL_PREFIX}-${XERCES_LATEST_RELEASE} ${XERCES_INSTALL_PREFIX}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"make"})," command is run in parallel (",(0,i.jsx)(n.code,{children:"-j$(nproc)"}),") to leverage all available CPU cores for faster builds. The ",(0,i.jsx)(n.code,{children:"nproc"})," command dynamically retrieves the number of cores."]}),"\n",(0,i.jsxs)(n.li,{children:["During ",(0,i.jsx)(n.code,{children:"make check"}),", failures listed as ",(0,i.jsx)(n.strong,{children:"XFAIL"})," (expected failures) are acceptable and do not indicate a problem with the build."]}),"\n",(0,i.jsx)(n.li,{children:"The output of the commands are saved to timestamped log files for future reference or troubleshooting."}),"\n"]})}),"\n",(0,i.jsx)(n.h3,{id:"52-clone-the-apache-cloudberry-repository",children:"5.2 Clone the Apache Cloudberry repository"}),"\n",(0,i.jsxs)(n.p,{children:["Clone the source code for Apache Cloudberry into the ",(0,i.jsx)(n.code,{children:"gpadmin"})," user's home directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/apache/cloudberry.git ~/cloudberry\ncd ~/cloudberry\n"})}),"\n",(0,i.jsx)(n.h3,{id:"53-configure-the-build-process",children:"5.3 Configure the build process"}),"\n",(0,i.jsx)(n.h4,{id:"531-prepare-environment",children:"5.3.1 Prepare environment"}),"\n",(0,i.jsx)(n.p,{children:"The build process requires the necessary libraries (e.g., Xerces-C) to be available at the expected locations for configuration and runtime. Prepare the environment using the following commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo rm -rf /usr/local/cloudberry-db\nsudo chmod a+w /usr/local\nmkdir -p /usr/local/cloudberry-db/lib\nsudo cp -v /usr/local/xerces-c/lib/libxerces-c.so \\\n           /usr/local/xerces-c/lib/libxerces-c-3.*.so \\\n           /usr/local/cloudberry-db/lib\nsudo chown -R gpadmin.gpadmin /usr/local/cloudberry-db\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"532-run-configure",children:["5.3.2 Run ",(0,i.jsx)(n.code,{children:"configure"})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"configure"})," command sets up the build environment for Apache Cloudberry. This configuration includes several development features and extensions."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'cd ~/cloudberry\nexport LD_LIBRARY_PATH=/usr/local/cloudberry-db/lib:LD_LIBRARY_PATH\n./configure --prefix=/usr/local/cloudberry-db \\\n            --disable-external-fts \\\n            --enable-debug \\\n            --enable-cassert \\\n            --enable-debug-extensions \\\n            --enable-gpcloud \\\n            --enable-ic-proxy \\\n            --enable-mapreduce \\\n            --enable-orafce \\\n            --enable-orca \\\n            --enable-pxf \\\n            --enable-tap-tests \\\n            --with-gssapi \\\n            --with-ldap \\\n            --with-libxml \\\n            --with-lz4 \\\n            --with-openssl \\\n            --with-pam \\\n            --with-perl \\\n            --with-pgport=5432 \\\n            --with-python \\\n            --with-pythonsrc-ext \\\n            --with-ssl=openssl \\\n            --with-openssl \\\n            --with-uuid=e2fs \\\n            --with-includes=/usr/local/xerces-c/include \\\n            --with-libraries=/usr/local/cloudberry-db/lib | tee ~/cloudberry/configure-$(date "+%Y.%m.%d-%H.%M.%S").log\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["The output of the ",(0,i.jsx)(n.code,{children:"configure"})," command is saved to a timestamped log file for future reference or troubleshooting."]})}),"\n",(0,i.jsx)(n.h3,{id:"54-build-and-install-apache-cloudberry-and-contrib-extensions",children:"5.4 Build and install Apache Cloudberry and contrib extensions"}),"\n",(0,i.jsx)(n.h4,{id:"541-compile-the-code",children:"5.4.1 Compile the code"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Uses the following command to compile the core components of Apache Cloudberry:\nmake -j$(nproc) --directory=~/cloudberry | tee ~/cloudberry/make-$(date "+%Y.%m.%d-%H.%M.%S").log\n\n# Compiles additional contrib modules, which provide optional features and extensions:\nmake -j$(nproc) --directory=~/cloudberry/contrib | tee ~/cloudberry/make-contrib-$(date "+%Y.%m.%d-%H.%M.%S").log\n'})}),"\n",(0,i.jsx)(n.h4,{id:"542-install-the-compiled-binaries",children:"5.4.2 Install the compiled binaries"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Installs the core components to the specified installation directory:\nmake install --directory=~/cloudberry | tee ~/cloudberry/make-install-$(date "+%Y.%m.%d-%H.%M.%S").log\n\n# Installs the contrib modules to the specified installation directory:\nmake install --directory=~/cloudberry/contrib | tee ~/cloudberry/make-contrib-install-$(date "+%Y.%m.%d-%H.%M.%S").log\n'})}),"\n",(0,i.jsx)(n.h3,{id:"55-verify-installation",children:"5.5 Verify installation"}),"\n",(0,i.jsx)(n.p,{children:"After installation, verify the setup with these steps:"}),"\n",(0,i.jsx)(n.h4,{id:"551-check-cloudberry-version",children:"5.5.1 Check Cloudberry version"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"/usr/local/cloudberry-db/bin/postgres --gp-version\n/usr/local/cloudberry-db/bin/postgres --version\n"})}),"\n",(0,i.jsx)(n.h4,{id:"552-verify-library-dependencies",children:"5.5.2 Verify library dependencies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ldd /usr/local/cloudberry-db/bin/postgres\n"})}),"\n",(0,i.jsx)(n.h4,{id:"553-check-library-extensions",children:"5.5.3 Check library extensions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ls -al /usr/local/cloudberry-db/share/postgresql/extension\n"})}),"\n",(0,i.jsx)(n.h4,{id:"554-check-core-utilities",children:"5.5.4 Check core utilities"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ls -l /usr/local/cloudberry-db/bin/\n"})}),"\n",(0,i.jsx)(n.p,{children:"Expected output should show critical binaries like postgres, initdb, etc."}),"\n",(0,i.jsx)(n.h3,{id:"56-common-issues",children:"5.6 Common issues"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Configure fails with missing dependencies:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Verify all required packages are installed."}),"\n",(0,i.jsx)(n.li,{children:"Check the configure log file for specific errors."}),"\n",(0,i.jsx)(n.li,{children:"Ensure CRB repository is properly enabled."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Build fails with compilation errors:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check make logs for specific errors."}),"\n",(0,i.jsx)(n.li,{children:"Ensure sufficient system resources are available."}),"\n",(0,i.jsx)(n.li,{children:"Verify Xerces-C installation is correct."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Library loading issues:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Verify ",(0,i.jsx)(n.code,{children:"LD_LIBRARY_PATH"})," includes required directories."]}),"\n",(0,i.jsx)(n.li,{children:"Check library permissions."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For detailed error messages, review the timestamped log files created during the installation process."}),"\n",(0,i.jsxs)(n.p,{children:["You have successfully built and installed Apache Cloudberry on Rocky Linux 9. The installation directory is ",(0,i.jsx)(n.code,{children:"/usr/local/cloudberry-db"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"6-set-up-a-cloudberry-development-cluster",children:"6. Set up a Cloudberry development cluster"}),"\n",(0,i.jsx)(n.p,{children:"This guide walks through setting up a Cloudberry demo cluster, and testing basic functionality. The demo cluster includes a coordinator, standby coordinator, and multiple primary/mirror segments all running on a single development host."}),"\n",(0,i.jsx)(n.h3,{id:"61-set-up-initial-container-not-required-for-all-environments",children:"6.1 Set up initial container (not required for all environments)"}),"\n",(0,i.jsx)(n.p,{children:"Container environments typically don't start the SSH daemon process by default. Since Cloudberry relies heavily on SSH for inter-process communication, we need to initialize and start the SSH server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'if ! pgrep sshd > /dev/null; then\n    echo "SSH daemon not running. Starting it now..."\n    sudo ssh-keygen -A\n    echo "PasswordAuthentication yes" | sudo tee -a /etc/ssh/sshd_config\n    sudo /usr/sbin/sshd\nelse\n    echo "SSH daemon is already running"\nfi\n'})}),"\n",(0,i.jsx)(n.h3,{id:"62-configure-ssh-for-cloudberry",children:"6.2 Configure SSH for Cloudberry"}),"\n",(0,i.jsx)(n.p,{children:"Cloudberry uses SSH for coordinator-segment communication. The following commands ensure SSH is properly configured for the gpadmin user by adding the host to known_hosts and verifying SSH connectivity:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh-keyscan $(hostname) >> ~/.ssh/known_hosts\nssh $(hostname) date\n"})}),"\n",(0,i.jsx)(n.h3,{id:"63-set-up-cloudberry-environment-variables",children:"6.3 Set up Cloudberry environment variables"}),"\n",(0,i.jsx)(n.p,{children:"Load Cloudberry environment variables that set up paths for binaries, libraries, and other essential components:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source /usr/local/cloudberry-db/greenplum_path.sh\n"})}),"\n",(0,i.jsx)(n.h3,{id:"64-create-development-cluster",children:"6.4 Create development cluster"}),"\n",(0,i.jsx)(n.p,{children:"Create a demo cluster that simulates a full Cloudberry deployment on a single machine. This includes 1 coordinator, 1 standby coordinator, 3 primary segments, and 3 mirror segments:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'make create-demo-cluster --directory=~/cloudberry | tee ~/cloudberry/make-create-demo-cluster-$(date "+%Y.%m.%d-%H.%M.%S").log\n'})}),"\n",(0,i.jsx)(n.h3,{id:"65-configure-cluster-environment",children:"6.5 Configure cluster environment"}),"\n",(0,i.jsx)(n.p,{children:"After cluster creation, verify and load cluster-specific variables that point to the coordinator port and data directory:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source ~/cloudberry/gpAux/gpdemo/gpdemo-env.sh\n"})}),"\n",(0,i.jsx)(n.h3,{id:"66-validate-cluster-deployment",children:"6.6 Validate cluster deployment"}),"\n",(0,i.jsx)(n.p,{children:"Verify the cluster is running correctly with these essential commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Displays detailed cluster state including segment status\ngpstate\n\n# Tests cluster shutdown and startup\ngpstop -a\ngpstart -a\n\n# Confirms Cloudberry version and build\npsql template1 -c 'SELECT version()'\n\n# Views segment configuration showing primary/mirror relationships\npsql template1 -c 'SELECT * from gp_segment_configuration'\n\n# Checks available PostgreSQL extensions\npsql template1 -c 'SELECT * FROM pg_available_extensions'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"67-extension-testing-example-pg_stat_statements",children:"6.7 Extension Testing Example: pg_stat_statements"}),"\n",(0,i.jsxs)(n.p,{children:["This example demonstrates how to enable and test the ",(0,i.jsx)(n.code,{children:"pg_stat_statements"})," extension, which provides statistics about SQL query execution:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Creates a database for testing\ncreatedb gpadmin\n\n# Enables the extension by adding it to shared libraries\necho \"shared_preload_libraries='pg_stat_statements'\" >> $COORDINATOR_DATA_DIRECTORY/postgresql.conf\n\n# Restarts cluster to load the new library (-r flag means \"restart\")\ngpstop -ar\n\n# Creates the extension in the database\npsql gpadmin -e -c 'CREATE EXTENSION pg_stat_statements'\n\n# Runs test queries to generate statistics\npsql gpadmin --echo-queries <<EOF\n-- Create a sample table\nCREATE TABLE employees (\n    id SERIAL PRIMARY KEY,\n    name TEXT,\n    department TEXT,\n    salary NUMERIC\n);\n\n-- Insert sample data\nINSERT INTO employees (name, department, salary)\nVALUES\n('Alice', 'HR', 60000),\n('Bob', 'Engineering', 80000),\n('Charlie', 'Marketing', 70000);\n\n-- Query the data to generate some statistics\nSELECT * FROM employees WHERE department = 'Engineering';\nSELECT AVG(salary) FROM employees;\n\n-- View most frequently called queries\nSELECT query, calls, total_exec_time AS total_time, rows\nFROM pg_stat_statements\nORDER BY calls DESC\nLIMIT 5;\n\n-- View most time-consuming queries\nSELECT query, calls, total_exec_time AS total_time, rows\nFROM pg_stat_statements\nORDER BY total_exec_time DESC\nLIMIT 5;\nEOF\n"})}),"\n",(0,i.jsx)(n.h3,{id:"68-destroy-development-cluster",children:"6.8 Destroy development cluster"}),"\n",(0,i.jsx)(n.p,{children:"To clean up and start fresh, you can destroy the demo cluster:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'make destroy-demo-cluster --directory=~/cloudberry | tee ~/cloudberry/make-create-demo-cluster-$(date "+%Y.%m.%d-%H.%M.%S").log\n'})}),"\n",(0,i.jsx)(n.p,{children:"This command removes all cluster data and configuration, allowing you to create a new clean cluster if needed."}),"\n",(0,i.jsx)(n.h3,{id:"69-troubleshoot-ssh-connection-issues",children:"6.9 Troubleshoot SSH connection issues"}),"\n",(0,i.jsxs)(n.p,{children:["When running ",(0,i.jsx)(n.code,{children:"create-demo-cluster"}),", the process may hang if SSH host verification hasn't been completed. This typically manifests as a stalled process waiting for user input to verify the host identity."]}),"\n",(0,i.jsx)(n.p,{children:"This is why we run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh-keyscan $(hostname) >> ~/.ssh/known_hosts\n"})}),"\n",(0,i.jsx)(n.p,{children:"before creating the cluster. This command automatically adds the host's SSH keys to the known_hosts file, preventing interactive prompts during cluster creation."}),"\n",(0,i.jsx)(n.p,{children:"If you still encounter SSH issues:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Verify that the SSH daemon is running"}),"\n",(0,i.jsx)(n.li,{children:"Check that the known_hosts file exists and has the correct permissions"}),"\n",(0,i.jsxs)(n.li,{children:["Test SSH connectivity with ",(0,i.jsx)(n.code,{children:"ssh $(hostname) date"})," before proceeding with cluster creation"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"7-validate-basic-functionalities",children:"7. Validate basic functionalities"}),"\n",(0,i.jsx)(n.p,{children:"Run the installcheck test suite to verify basic functionality. It is recommended to test with both Orca (the query optimizer) enabled and disabled:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Run tests with Orca optimizer enabled\nPGOPTIONS='-c optimizer=on' make --directory=~/cloudberry installcheck\n\n# Run tests with Orca optimizer disabled\nPGOPTIONS='-c optimizer=off' make --directory=~/cloudberry installcheck\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Even though Orca is the default Cloudberry optimizer, you must explicitly set ",(0,i.jsx)(n.code,{children:"optimizer=on"})," when running installcheck. Without this setting, the ",(0,i.jsx)(n.code,{children:"explain"})," test will fail due to missing the explicit configuration option."]})}),"\n",(0,i.jsx)(n.h3,{id:"71-test-results",children:"7.1 Test results"}),"\n",(0,i.jsx)(n.p,{children:"The installcheck target provides a basic test of functionality. During execution, you'll see output like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"test tablespace                   ... ok         3236 ms (diff   76 ms)\nparallel group (20 tests):  pg_lsn oid txid name char varchar int2 regproc text ...\n     boolean                      ... ok          862 ms (diff   56 ms)\n     char                         ... ok          419 ms (diff   87 ms)\n     explain                      ... FAILED      310 ms (diff  139 ms)\n"})}),"\n",(0,i.jsx)(n.p,{children:"At the end, you'll see a summary, for example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"========================\n 1 of 658 tests failed. \n========================\n"})}),"\n",(0,i.jsx)(n.p,{children:"If any tests fail:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"regression.diffs"}),": Shows differences between actual and expected results"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"regression.out"}),": Contains the complete test execution output"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The files will be located in ",(0,i.jsx)(n.code,{children:"/home/gpadmin/cloudberry/src/test/regress/"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"installcheck is just one of several test schedules available. This guide focuses on basic development environment setup and validation."})}),"\n",(0,i.jsx)(n.h3,{id:"72-troubleshoot-test-failures",children:"7.2 Troubleshoot test failures"}),"\n",(0,i.jsx)(n.p,{children:"If a test fails, you might need to examine the log files from various cluster components. You can locate the data directories containing these logs by querying the segment configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"psql -P pager=off template1 -c 'SELECT * from gp_segment_configuration'\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This shows the complete cluster configuration. The ",(0,i.jsx)(n.code,{children:"content = -1"})," identifies coordinator nodes:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:" dbid | content | role | preferred_role | mode | status | port | hostname | address |                                  datadir                                   | warehouseid \n------+---------+------+----------------+------+--------+------+----------+---------+----------------------------------------------------------------------------+-------------\n    1 |      -1 | p    | p              | n    | u      | 7000 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/qddir/demoDataDir-1         |           0\n    8 |      -1 | m    | m              | s    | u      | 7001 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/standby                     |           0\n    2 |       0 | p    | p              | s    | u      | 7002 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast1/demoDataDir0        |           0\n    5 |       0 | m    | m              | s    | u      | 7005 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast_mirror1/demoDataDir0 |           0\n    3 |       1 | p    | p              | s    | u      | 7003 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast2/demoDataDir1        |           0\n    6 |       1 | m    | m              | s    | u      | 7006 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast_mirror2/demoDataDir1 |           0\n    4 |       2 | p    | p              | s    | u      | 7004 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast3/demoDataDir2        |           0\n    7 |       2 | m    | m              | s    | u      | 7007 | mdw      | mdw     | /home/gpadmin/cloudberry/gpAux/gpdemo/datadirs/dbfast_mirror3/demoDataDir2 |           0\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Each ",(0,i.jsx)(n.code,{children:"datadir"})," contains log files that can help diagnose test failures. Review the logs in the relevant component's directory based on which test failed."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},11151:(e,n,s)=>{s.d(n,{Z:()=>o,a:()=>t});var i=s(67294);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);