"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[26502],{33186:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>n,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var r=o(85893),i=o(11151);const a={title:"Recover a Failed Coordinator"},n="Recover a Failed Coordinator",s={id:"sys-admin/high-availability/recover-a-failed-coordinator",title:"Recover a Failed Coordinator",description:"If the primary coordinator fails, the Apache Cloudberry system is not accessible and WAL replication stops. Use gpactivatestandby to activate the standby coordinator. Upon activation of the standby coordinator, Apache Cloudberry reconstructs the coordinator host state at the time of the last successfully committed transaction.",source:"@site/docs/sys-admin/high-availability/recover-a-failed-coordinator.md",sourceDirName:"sys-admin/high-availability",slug:"/sys-admin/high-availability/recover-a-failed-coordinator",permalink:"/docs/next/sys-admin/high-availability/recover-a-failed-coordinator",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/docs/sys-admin/high-availability/recover-a-failed-coordinator.md",tags:[],version:"current",lastUpdatedBy:"Bhargav",lastUpdatedAt:1765766034,formattedLastUpdatedAt:"Dec 15, 2025",frontMatter:{title:"Recover a Failed Coordinator"},sidebar:"docsbars",previous:{title:"Recover from Segment Failures",permalink:"/docs/next/sys-admin/high-availability/recover-from-segment-failures"},next:{title:"Restore Coordinator Mirroring After a Recovery",permalink:"/docs/next/sys-admin/high-availability/restore-coordinator-mirroring-after-a-recovery"}},c={},d=[{value:"To activate the standby coordinator",id:"to-activate-the-standby-coordinator",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"recover-a-failed-coordinator",children:"Recover a Failed Coordinator"}),"\n",(0,r.jsxs)(t.p,{children:["If the primary coordinator fails, the Apache Cloudberry system is not accessible and WAL replication stops. Use ",(0,r.jsx)(t.a,{href:"/docs/next/sys-utilities/gpactivatestandby",children:(0,r.jsx)(t.code,{children:"gpactivatestandby"})})," to activate the standby coordinator. Upon activation of the standby coordinator, Apache Cloudberry reconstructs the coordinator host state at the time of the last successfully committed transaction."]}),"\n",(0,r.jsxs)(t.p,{children:["These steps assume a standby coordinator host is configured for the system. See ",(0,r.jsx)(t.a,{href:"/docs/next/sys-admin/high-availability/enable-coordinator-mirroring",children:"Enable Coordinator Mirroring"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"to-activate-the-standby-coordinator",children:"To activate the standby coordinator"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Run the ",(0,r.jsx)(t.code,{children:"gpactivatestandby"})," utility from the standby coordinator host you are activating. For example:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"$ export PGPORT=5432\n$ gpactivatestandby -d /data/coordinator/gpseg-1\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Where ",(0,r.jsx)(t.code,{children:"-d"})," specifies the data directory of the coordinator host you are activating."]}),"\n",(0,r.jsxs)(t.p,{children:["After you activate the standby, it becomes the ",(0,r.jsx)(t.em,{children:"active"})," or ",(0,r.jsx)(t.em,{children:"primary"})," coordinator for your Apache Cloudberry array."]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["Before running ",(0,r.jsx)(t.code,{children:"gpactivatestandby"}),", be sure to run ",(0,r.jsx)(t.code,{children:"gpstate -f"})," to confirm that the standby coordinator is synchronized with the current coordinator node. If synchronized, the final line of the ",(0,r.jsx)(t.code,{children:"gpstate -f"})," output will look similar to this: ",(0,r.jsx)(t.code,{children:"20230607:06:50:06:004205 gpstate:test1-m:gpadmin-[INFO]:--Sync state: sync"}),"."]})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["After the utility completes, run ",(0,r.jsx)(t.code,{children:"gpstate"})," with the ",(0,r.jsx)(t.code,{children:"-b"})," option to display a summary of the system status:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"$ gpstate -b\n"})}),"\n",(0,r.jsxs)(t.p,{children:["The coordinator instance status should be ",(0,r.jsx)(t.code,{children:"Active"}),". When a standby coordinator is not configured, the command displays ",(0,r.jsx)(t.code,{children:"No coordinator standby configured"})," for the standby coordinator status. If you configured a new standby coordinator, its status is ",(0,r.jsx)(t.code,{children:"Passive"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Optional: If you have not already done so while activating the prior standby coordinator, you can run ",(0,r.jsx)(t.code,{children:"gpinitstandby"})," on the active coordinator host to configure a new standby coordinator."]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"You need to initialize a new standby coordinator to continue providing coordinator mirroring."})}),"\n",(0,r.jsxs)(t.p,{children:["For information about restoring the original coordinator and standby coordinator configuration, see ",(0,r.jsx)(t.a,{href:"/docs/next/sys-admin/high-availability/restore-coordinator-mirroring-after-a-recovery",children:"Restore Coordinator Mirroring After a Recovery"}),"."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},11151:(e,t,o)=>{o.d(t,{Z:()=>s,a:()=>n});var r=o(67294);const i={},a=r.createContext(i);function n(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);