"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[3979],{50208:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var s=n(85893),a=n(11151);const i={title:"Text Search Configuration Example"},o="Text Search Configuration Example",r={id:"operate-with-data/sql-queries/full-text-search/text-search-configuration",title:"Text Search Configuration Example",description:"This document shows how to create a customized text search configuration to process document and query text.",source:"@site/docs/operate-with-data/sql-queries/full-text-search/text-search-configuration.md",sourceDirName:"operate-with-data/sql-queries/full-text-search",slug:"/operate-with-data/sql-queries/full-text-search/text-search-configuration",permalink:"/docs/next/operate-with-data/sql-queries/full-text-search/text-search-configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/docs/operate-with-data/sql-queries/full-text-search/text-search-configuration.md",tags:[],version:"current",lastUpdatedBy:"Dianjin Wang",lastUpdatedAt:1750834088,formattedLastUpdatedAt:"Jun 25, 2025",frontMatter:{title:"Text Search Configuration Example"},sidebar:"docsbars",previous:{title:"Text Search Dictionaries",permalink:"/docs/next/operate-with-data/sql-queries/full-text-search/text-search-dictionaries"},next:{title:"Test and Debug Text Search",permalink:"/docs/next/operate-with-data/sql-queries/full-text-search/test-and-debug-text-search"}},c={},l=[];function d(e){const t={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"text-search-configuration-example",children:"Text Search Configuration Example"}),"\n",(0,s.jsx)(t.p,{children:"This document shows how to create a customized text search configuration to process document and query text."}),"\n",(0,s.jsxs)(t.p,{children:["A text search configuration specifies all options necessary to transform a document into a ",(0,s.jsx)(t.code,{children:"tsvector"}),": the parser to use to break text into tokens, and the dictionaries to use to transform each token into a lexeme. Every call of ",(0,s.jsx)(t.code,{children:"to_tsvector"})," or ",(0,s.jsx)(t.code,{children:"to_tsquery"})," needs a text search configuration to perform its processing. The configuration parameter ",(0,s.jsx)(t.code,{children:"default_text_search_config"})," specifies the name of the default configuration, which is the one used by text search functions if an explicit configuration parameter is omitted. It can be set in ",(0,s.jsx)(t.code,{children:"postgresql.conf"})," using the ",(0,s.jsx)(t.code,{children:"gpconfig"})," command-line utility, or set for an individual session using the ",(0,s.jsx)(t.code,{children:"SET"})," command."]}),"\n",(0,s.jsxs)(t.p,{children:["Several predefined text search configurations are available, and you can create custom configurations easily. To facilitate management of text search objects, a set of SQL commands is available, and there are several psql commands that display information about text search objects (",(0,s.jsx)(t.a,{href:"/docs/next/operate-with-data/sql-queries/full-text-search/text-search-psql-support",children:"psql Support"}),")."]}),"\n",(0,s.jsxs)(t.p,{children:["As an example, you can create a configuration ",(0,s.jsx)(t.code,{children:"pg"}),", starting by duplicating the built-in ",(0,s.jsx)(t.code,{children:"english"})," configuration:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE TEXT SEARCH CONFIGURATION public.pg ( COPY = pg_catalog.english );\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You can use a PostgreSQL-specific synonym list and store it in ",(0,s.jsx)(t.code,{children:"$SHAREDIR/tsearch_data/pg_dict.syn"}),". The file contents look like:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"postgres    pg\npgsql       pg\npostgresql  pg\n"})}),"\n",(0,s.jsx)(t.p,{children:"Define the synonym dictionary like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE TEXT SEARCH DICTIONARY pg_dict (\n    TEMPLATE = synonym,\n    SYNONYMS = pg_dict\n);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Next, register the Ispell dictionary ",(0,s.jsx)(t.code,{children:"english_ispell"}),", which has its own configuration files:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE TEXT SEARCH DICTIONARY english_ispell (\n    TEMPLATE = ispell,\n    DictFile = english,\n    AffFile = english,\n    StopWords = english\n);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Set up the mappings for words in configuration ",(0,s.jsx)(t.code,{children:"pg"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"ALTER TEXT SEARCH CONFIGURATION pg\n    ALTER MAPPING FOR asciiword, asciihword, hword_asciipart,\n                      word, hword, hword_part\n    WITH pg_dict, english_ispell, english_stem;\n"})}),"\n",(0,s.jsx)(t.p,{children:"Choose not to index or search some token types that the built-in configuration does handle:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"ALTER TEXT SEARCH CONFIGURATION pg\n    DROP MAPPING FOR email, url, url_path, sfloat, float;\n"})}),"\n",(0,s.jsx)(t.p,{children:"Now test the configuration:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"SELECT * FROM ts_debug('public.pg', '\nPostgreSQL, the highly scalable, SQL compliant, open source object-relational\ndatabase management system, is now undergoing beta testing of the next\nversion of our software.\n');\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The next step is to set the session to use the new configuration, which was created in the ",(0,s.jsx)(t.code,{children:"public"})," schema:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"SET text_search_config = 'public.pg';\n=> \\dF\n   List of text search configurations\n Schema  | Name | Description\n---------+------+-------------\n public  | pg   |\n\nSET default_text_search_config = 'public.pg';\nSET\n\nSHOW default_text_search_config;\n default_text_search_config\n----------------------------\n public.pg\n"})})]})}function h(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>o});var s=n(67294);const a={},i=s.createContext(a);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);