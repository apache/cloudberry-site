"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[26309],{41689:(t,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var a=s(85893),n=s(11151);const o={title:"pg_stat_last_operation"},i="pg_stat_last_operation",r={id:"sys-catalogs/sys-tables/pg-stat-last-operation",title:"pg_stat_last_operation",description:"The pgstatlast_operation table contains metadata tracking information about database objects (such as tables, views).",source:"@site/docs/sys-catalogs/sys-tables/pg-stat-last-operation.md",sourceDirName:"sys-catalogs/sys-tables",slug:"/sys-catalogs/sys-tables/pg-stat-last-operation",permalink:"/docs/next/sys-catalogs/sys-tables/pg-stat-last-operation",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/docs/sys-catalogs/sys-tables/pg-stat-last-operation.md",tags:[],version:"current",lastUpdatedBy:"Dianjin Wang",lastUpdatedAt:1754561742,formattedLastUpdatedAt:"Aug 7, 2025",frontMatter:{title:"pg_stat_last_operation"},sidebar:"docsbars",previous:{title:"pg_shdescription",permalink:"/docs/next/sys-catalogs/sys-tables/pg-shdescription"},next:{title:"pg_stat_last_shoperation",permalink:"/docs/next/sys-catalogs/sys-tables/pg-stat-last-shoperation"}},d={},c=[];function l(t){const e={code:"code",h1:"h1",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.a)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h1,{id:"pg_stat_last_operation",children:"pg_stat_last_operation"}),"\n",(0,a.jsx)(e.p,{children:"The pg_stat_last_operation table contains metadata tracking information about database objects (such as tables, views)."}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"column"}),(0,a.jsx)(e.th,{children:"type"}),(0,a.jsx)(e.th,{children:"references"}),(0,a.jsx)(e.th,{children:"description"})]})}),(0,a.jsxs)(e.tbody,{children:[(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"classid"})}),(0,a.jsx)(e.td,{children:"oid"}),(0,a.jsx)(e.td,{children:"pg_class.oid"}),(0,a.jsx)(e.td,{children:"OID of the system catalog containing the object."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"objid"})}),(0,a.jsx)(e.td,{children:"oid"}),(0,a.jsx)(e.td,{children:"any OID column"}),(0,a.jsx)(e.td,{children:"OID of the object within its system catalog."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"staactionname"})}),(0,a.jsx)(e.td,{children:"name"}),(0,a.jsx)(e.td,{children:"\xa0"}),(0,a.jsx)(e.td,{children:"The action that was taken on the object."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"stasysid"})}),(0,a.jsx)(e.td,{children:"oid"}),(0,a.jsx)(e.td,{children:"pg_authid.oid"}),(0,a.jsx)(e.td,{children:"A foreign key to pg_authid.oid."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"stausename"})}),(0,a.jsx)(e.td,{children:"name"}),(0,a.jsx)(e.td,{children:"\xa0"}),(0,a.jsx)(e.td,{children:"The name of the role that performed the operation on this object."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"stasubtype"})}),(0,a.jsx)(e.td,{children:"text"}),(0,a.jsx)(e.td,{children:"\xa0"}),(0,a.jsx)(e.td,{children:"The type of object operated on or the subclass of operation performed."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"statime"})}),(0,a.jsx)(e.td,{children:"timestamp with timezone"}),(0,a.jsx)(e.td,{children:"\xa0"}),(0,a.jsx)(e.td,{children:"The timestamp of the operation. This is the same timestamp that is written to the Apache Cloudberry server log files in case you need to look up more detailed information about the operation in the logs."})]})]})]}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"pg_stat_last_operation"})," table contains metadata tracking information about operations on database objects. This information includes the object id, DDL action, user, type of object, and operation timestamp. Apache Cloudberry updates this table when a database object is created, altered, truncated, vacuumed, analyzed, or partitioned, and when privileges are granted to an object."]}),"\n",(0,a.jsxs)(e.p,{children:["If you want to track the operations performed on a specific object, use the ",(0,a.jsx)(e.code,{children:"objid"})," value. Because the ",(0,a.jsx)(e.code,{children:"stasubtype"})," value can identify either the type of object operated on or the subclass of operation performed, it is not a suitable parameter when querying the ",(0,a.jsx)(e.code,{children:"pg_stat_last_operation"})," table."]}),"\n",(0,a.jsxs)(e.p,{children:["The following example creates and replaces a view, and then shows how to use ",(0,a.jsx)(e.code,{children:"objid"})," as a query parameter on the ",(0,a.jsx)(e.code,{children:"pg_stat_last_operation"})," table."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sql",children:"testdb=# CREATE VIEW trial AS SELECT * FROM gp_segment_configuration;\n\nREATE VIEW\n\ntestdb=# CREATE OR REPLACE VIEW trial AS SELECT * FROM gp_segment_configuration;\n\nCREATE VIEW\n\ntestdb=# SELECT * FROM pg_stat_last_operation WHERE objid='trial'::regclass::oid;\n\n classid | objid | staactionname | stasysid | stausename | stasubtype |            statime            \n---------+-------+---------------+----------+------------+------------+-------------------------------\n  1259  | 24735 | CREATE         |       10 | gpadmin    | VIEW       | 2020-04-07 16:44:28.808811+00\n  1259  | 24735 | ALTER          |       10 | gpadmin    | SET        | 2020-04-07 16:44:38.110615+00\n(2 rows)\n"})}),"\n",(0,a.jsxs)(e.p,{children:["Notice that the ",(0,a.jsx)(e.code,{children:"pg_stat_last_operation"})," table entry for the view ",(0,a.jsx)(e.code,{children:"REPLACE"})," operation specifies the ",(0,a.jsx)(e.code,{children:"ALTER"})," action (",(0,a.jsx)(e.code,{children:"staactionname"}),") and the ",(0,a.jsx)(e.code,{children:"SET"})," subtype (",(0,a.jsx)(e.code,{children:"stasubtype"}),")."]})]})}function h(t={}){const{wrapper:e}={...(0,n.a)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(l,{...t})}):l(t)}},11151:(t,e,s)=>{s.d(e,{Z:()=>r,a:()=>i});var a=s(67294);const n={},o=a.createContext(n);function i(t){const e=a.useContext(o);return a.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function r(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(n):t.components||n:i(t.components),a.createElement(o.Provider,{value:e},t.children)}}}]);