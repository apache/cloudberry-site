"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[48071],{35135:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var s=i(85893),r=i(11151);const t={title:"GPORCA Limitations"},o="GPORCA Limitations",a={id:"performance/optimize-queries/use-orca/gporca-limitations",title:"GPORCA Limitations",description:"There are limitations in Apache Cloudberry when using the default GPORCA optimizer. GPORCA and the Postgres-based planner currently coexist in Apache Cloudberry because GPORCA does not support all Apache Cloudberry features.",source:"@site/versioned_docs/version-2.x/performance/optimize-queries/use-orca/gporca-limitations.md",sourceDirName:"performance/optimize-queries/use-orca",slug:"/performance/optimize-queries/use-orca/gporca-limitations",permalink:"/docs/performance/optimize-queries/use-orca/gporca-limitations",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/versioned_docs/version-2.x/performance/optimize-queries/use-orca/gporca-limitations.md",tags:[],version:"2.x",lastUpdatedBy:"Alwin",lastUpdatedAt:1750319831,formattedLastUpdatedAt:"Jun 19, 2025",frontMatter:{title:"GPORCA Limitations"},sidebar:"docsbars",previous:{title:"Collect Root Partition Statistics",permalink:"/docs/performance/optimize-queries/use-orca/gporca-collect-root-partition-stats"},next:{title:"Considerations when using GPORCA",permalink:"/docs/performance/optimize-queries/use-orca/gporca-usage-considerations"}},l={},c=[{value:"Unsupported SQL query features",id:"unsupported-sql-query-features",level:2},{value:"Performance regressions",id:"performance-regressions",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"gporca-limitations",children:"GPORCA Limitations"}),"\n",(0,s.jsx)(n.p,{children:"There are limitations in Apache Cloudberry when using the default GPORCA optimizer. GPORCA and the Postgres-based planner currently coexist in Apache Cloudberry because GPORCA does not support all Apache Cloudberry features."}),"\n",(0,s.jsx)(n.p,{children:"This section describes the limitations."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#unsupported-sql-query-features",children:"Unsupported SQL Query Features"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#performance-regressions",children:"Performance Regressions"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"unsupported-sql-query-features",children:"Unsupported SQL query features"}),"\n",(0,s.jsx)(n.p,{children:"Certain query features are not supported with the default GPORCA optimizer. When an unsupported query is run, Cloudberry logs this notice along with the query text:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Falling back to Postgres-based planner because GPORCA does not support the following feature: UTILITY command\n"})}),"\n",(0,s.jsx)(n.p,{children:"These features are unsupported when GPORCA is enabled (the default):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SP-GiST indexing method. GPORCA supports only B-tree, bitmap, GIN, and GiST indexes. GPORCA ignores indexes created with unsupported methods."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"SELECT"})," command's ",(0,s.jsx)(n.code,{children:"TABLESAMPLE"})," clause."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The optional ",(0,s.jsx)(n.code,{children:"WITH ORDINALITY"})," clause of a function call inside the ",(0,s.jsx)(n.code,{children:"FROM"})," clause of a ",(0,s.jsx)(n.code,{children:"SELECT"})," command."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Multi-level partitioned tables."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Non-uniform partitioned tables."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"SortMergeJoin (SMJ)."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Ordered aggregations."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Multi-argument ",(0,s.jsx)(n.code,{children:"DISTINCT"})," qualified aggregates, for example ",(0,s.jsx)(n.code,{children:"SELECT corr(DISTINCT a, b) FROM tbl1;"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Multiple grouping sets specified using a duplicate alias in a null-producing grouping set spec. Such queries fall back to the Postgres-based planner unless you directly coerce the alias to a separate variable as shown in the example below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TEMP TABLE tempt AS SELECT i AS ai1, i AS ai2 FROM generate_series(1, 3)i;\nSELECT ai1, ai2 FROM tempt GROUP BY ai2, ROLLUP(ai1) ORDER BY ai1, ai2;\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"These scalar operators:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ROW"}),"\n",(0,s.jsx)(n.li,{children:"ROWCOMPARE"}),"\n",(0,s.jsx)(n.li,{children:"FIELDSELECT"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Aggregate functions that take set operators as input arguments."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Multiple Distinct Qualified Aggregates, such as ",(0,s.jsx)(n.code,{children:"SELECT count(DISTINCT a), sum(DISTINCT b) FROM foo"}),", are not supported by default. They can be enabled with the ",(0,s.jsx)(n.code,{children:"optimizer_enable_multiple_distinct_aggs"})," ",(0,s.jsx)(n.a,{href:"../../../ref_guide/config_params/guc-list.html",children:"Configuration Parameter"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"percentile_*"})," window functions (ordered-set aggregate functions)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Inverse distribution functions."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Queries that run functions that are defined with the ",(0,s.jsx)(n.code,{children:"ON COORDINATOR"})," or ",(0,s.jsx)(n.code,{children:"ON ALL SEGMENTS"})," attribute."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Queries that contain UNICODE characters in metadata names, such as table names, and the characters are not compatible with the host system locale."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"SELECT"}),", ",(0,s.jsx)(n.code,{children:"UPDATE"}),", and ",(0,s.jsx)(n.code,{children:"DELETE"})," commands where a table name is qualified by the ",(0,s.jsx)(n.code,{children:"ONLY"})," keyword."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Per-column collation. GPORCA supports collation only when all columns in the query use the same collation. If columns in the query use different collations, then Cloudberry uses the Postgres-based planner."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["DML and ",(0,s.jsx)(n.code,{children:"COPY ... FROM"})," operations on foreign tables."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance-regressions",children:"Performance regressions"}),"\n",(0,s.jsx)(n.p,{children:"The following features are known performance regressions that occur with GPORCA enabled:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Short running queries - For GPORCA, short running queries might encounter additional overhead due to GPORCA enhancements for determining an optimal query execution plan."}),"\n",(0,s.jsx)(n.li,{children:"ANALYZE - For GPORCA, the ANALYZE command generates root partition statistics for partitioned tables. For the Postgres-based planner, these statistics are not generated."}),"\n",(0,s.jsx)(n.li,{children:"DML operations - For GPORCA, DML enhancements including the support of updates on partition and distribution keys might require additional overhead."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Also, enhanced functionality of the features from previous versions could result in additional time required when GPORCA runs SQL statements with the features."})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>o});var s=i(67294);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);