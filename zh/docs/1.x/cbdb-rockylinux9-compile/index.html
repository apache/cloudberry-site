<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.x docs-doc-page docs-doc-id-cbdb-rockylinux9-compile" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">在 Rocky Linux 9 上 | Apache Cloudberry (Incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cloudberry.apache.org/zh/docs/1.x/cbdb-rockylinux9-compile"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="1.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.x"><meta data-rh="true" name="docsearch:version" content="1.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.x"><meta data-rh="true" property="og:title" content="在 Rocky Linux 9 上 | Apache Cloudberry (Incubating)"><meta data-rh="true" name="description" content="本文档来自 Building Apache Cloudberry (Incubating): A Development Environment Guide。"><meta data-rh="true" property="og:description" content="本文档来自 Building Apache Cloudberry (Incubating): A Development Environment Guide。"><link data-rh="true" rel="icon" href="/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cloudberry.apache.org/zh/docs/1.x/cbdb-rockylinux9-compile"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/docs/1.x/cbdb-rockylinux9-compile" hreflang="en"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/zh/docs/1.x/cbdb-rockylinux9-compile" hreflang="zh"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/docs/1.x/cbdb-rockylinux9-compile" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. Atom Feed">
<link rel="alternate" type="application/json" href="/zh/blog/feed.json" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. JSON Feed">




<link rel="preconnect" href="https://analytics.apache.org/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://analytics.apache.org/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","66"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script><link rel="stylesheet" href="/zh/assets/css/styles.9629f118.css">
<script src="/zh/assets/js/runtime~main.dd3beea1.js" defer="defer"></script>
<script src="/zh/assets/js/main.8de3ff1c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="tipsWrap_WWTe"><div class="tipsContent_sMsy"><div class="text_VINd"><a href="https://github.com/apache/cloudberry" target="_blank" rel="noopener noreferrer"><span>If you like Apache Cloudberry (Incubating), give it a star on GitHub! </span><img src="/img/home/hcard/star.svg" alt=""></a></div><div class="close_vVex"><img src="/img/home/hcard/close.svg" alt=""></div></div></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="nav-left-logo"><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/apache_cloudberry_color_black.svg" alt="Apache Cloudberry (Incubating)" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh/img/apache_cloudberry_color_white.svg" alt="Apache Cloudberry (Incubating)" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" versions="current,2.x,1.x" href="/zh/docs/1.x/">1.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/">下一版</a></li><li><a class="dropdown__link" href="/zh/docs/">2.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/1.x/cbdb-rockylinux9-compile">1.x</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs/1.x/">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/community">Overview</a></li><li><a class="dropdown__link" href="/zh/community/slack">Slack Guide</a></li><li><a class="dropdown__link" href="/zh/community/wechat">WeChat Guide</a></li><li><a class="dropdown__link" href="/zh/community/events">Community Events</a></li><li><a class="dropdown__link" href="/zh/community/mailing-lists">Mailing Lists</a></li><li><a class="dropdown__link" href="/zh/community/brand">Brand Guidelines</a></li><li><a class="dropdown__link" href="/zh/community/security">Security Policy</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Contribute</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/contribute">Overview</a></li><li><a class="dropdown__link" href="/zh/contribute/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/zh/contribute/git">Working with Git &amp; GitHub</a></li><li><a class="dropdown__link" href="/zh/contribute/code">Code Contribution Guide</a></li><li><a class="dropdown__link" href="/zh/contribute/proposal">Proposal Guide</a></li><li><a class="dropdown__link" href="/zh/contribute/doc">Doc Contribution Guide</a></li></ul></div><a class="navbar__item navbar__link" href="/zh/blog">Blog</a><a class="navbar__item navbar__link" href="/zh/releases">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Team</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/team">Who we are</a></li><li><a class="dropdown__link" href="/zh/team/new-committers">Inviting New Committers</a></li><li><a class="dropdown__link" href="/zh/team/sign-icla">Sign ICLA</a></li><li><a class="dropdown__link" href="/zh/team/setup-apache-email-account">Setup the Apache account</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a href="https://github.com/apache/cloudberry/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/cloudberry/discussions/868" target="_blank" rel="noopener noreferrer" class="dropdown__link">Roadmap</a></li><li><a href="https://github.com/apache/cloudberry/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum</a></li><li><a class="dropdown__link" href="/zh/support">Support</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of Conduct</a></li></ul></div><div class="toggle_vylO colorModeToggle_x44X check-theme-switch"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为暗黑模式）" aria-label="切换浅色/暗黑模式（当前为暗黑模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_BF9v"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_Rg9N"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebarViewport_pYEE"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/">产品介绍</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh/docs/1.x/cbdb-macos-compile">部署和构建</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/zh/docs/1.x/cbdb-macos-compile">从源码编译安装</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/1.x/cbdb-macos-compile">在 macOS 上</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/1.x/cbdb-rockylinux8-ubuntu-compile">在 Rocky Linux 8 和 Ubuntu 上</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/1.x/cbdb-rockylinux9-compile">在 Rocky Linux 9 上</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/zh/docs/1.x/cbdb-op-software-hardware">物理机/虚拟机部署</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/1.x/data-loading/">加载数据</a><button aria-label="展开侧边栏分类 &#x27;加载数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/create-and-manage-database">创建和准备数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/basic-query-syntax">操作数据</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/1.x/performance/">优化查询性能</a><button aria-label="展开侧边栏分类 &#x27;优化查询性能&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/1.x/security/">设置安全和权限</a><button aria-label="展开侧边栏分类 &#x27;设置安全和权限&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/sys-admin/backup-and-restore/">Manage System</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/developer/develop-extensions-using-rust">Developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/ecosystem/sql-clients/dbeaver">生态系统</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/1.x/sql-stmts/">参考指南</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_hjYf"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>此为 <!-- -->Apache Cloudberry (Incubating)<!-- --> <b>1.x</b> 版的文档，现已不再积极维护。</div><div class="margin-top--md">最新的文档请参阅 <b><a href="/zh/docs/">最新版本</a></b> (<!-- -->2.x<!-- -->)。</div></div><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_xK9p"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link" id="支付">部署和构建</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link" id="支付">从源码编译安装</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">在 Rocky Linux 9 上</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：1.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>在 Rocky Linux 9 上编译和安装 Apache Cloudberry</h1>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>本文档来自 <a href="https://github.com/edespino/cloudberry/blob/rocky9-dev-readme/deploy/build/README-rockylinux9.md" target="_blank" rel="noopener noreferrer">Building Apache Cloudberry (Incubating): A Development Environment Guide</a>。</p></div></div>
<p>本文适用于希望探索并可能为 Apache Cloudberry 做出贡献的开发人员。文中描述的构建环境仅适用于开发和测试。</p>
<p>若想了解如何在 Rocky Linux 8 和 Ubuntu 上编译和安装 Apache Cloudberry，请参考 <a href="/zh/i18n/zh/docusaurus-plugin-content-docs/current/cbdb-rockylinux8-ubuntu-compile.md">在 Rocky Linux 8 和 Ubuntu 上编译</a>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-目标受众">1. 目标受众<a href="#1-目标受众" class="hash-link" aria-label="1. 目标受众的直接链接" title="1. 目标受众的直接链接">​</a></h2>
<ul>
<li>想为 Apache Cloudberry 贡献代码的开发人员。</li>
<li>想探索 Cloudberry 扩展功能的 PostgreSQL 开发人员。</li>
<li>对分布式查询处理感兴趣的数据库爱好者。</li>
<li>考虑加入 Apache Cloudberry 社区的人员。</li>
</ul>
<p>通过本文描述的构建过程，你可以：</p>
<ul>
<li>调试和测试新功能。</li>
<li>使用开发工具深入了解代码库。</li>
<li>运行测试套件和验证检查。</li>
<li>修改代码并进行测试。</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>如果你是 Apache Cloudberry 或 PostgreSQL 开发的新手：</p><ul>
<li>建议先构建 PostgreSQL，熟悉基本工作流程。</li>
<li>加入项目邮件列表，与其他开发人员交流。</li>
<li>查看项目议题跟踪器，了解当前的开发重点。</li>
<li>探索代码库时，要做好应对较长构建时间和多次迭代测试的准备。</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-构建-apache-cloudberry-的过程">2. 构建 Apache Cloudberry 的过程<a href="#2-构建-apache-cloudberry-的过程" class="hash-link" aria-label="2. 构建 Apache Cloudberry 的过程的直接链接" title="2. 构建 Apache Cloudberry 的过程的直接链接">​</a></h2>
<p>Apache Cloudberry（孵化中）的构建过程和 PostgreSQL 基本一致。如果你之前搭建过 PostgreSQL 的开发环境，那么构建 Cloudberry 会让你有种似曾相识的 感觉。</p>
<p>对于 Cloudberry 或 PostgreSQL 的新手，我建议先从构建 PostgreSQL 开始。PostgreSQL 开发社区提供了丰富的文档和工具，能帮你顺利走完整个流程。熟悉了 PostgreSQL 的构建过程后，再转向 Cloudberry 就会容易很多。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-cloudberry-与-postgresql-的主要区别">3. Cloudberry 与 PostgreSQL 的主要区别<a href="#3-cloudberry-与-postgresql-的主要区别" class="hash-link" aria-label="3. Cloudberry 与 PostgreSQL 的主要区别的直接链接" title="3. Cloudberry 与 PostgreSQL 的主要区别的直接链接">​</a></h2>
<p>虽然整体流程差不多，但因为 Cloudberry 是分布式架构，所以在使用时会有一些额外的注意事项：</p>
<ul>
<li><strong>额外依赖</strong>：需要一些特定的库和工具，比如用于 Orca 查询优化器的 <code>xerces-c</code>。</li>
<li><strong>分布式特性</strong>：Cloudberry 在 PostgreSQL 的基础上增加了大规模并行处理功能，这会带来一些额外的配置步骤。</li>
</ul>
<p>熟悉 PostgreSQL 后，设置 Cloudberry 就会变得轻而易举。接下来的章节会一步步指导你完成 Cloudberry 的构建和运行时设置。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-准备工作">4. 准备工作<a href="#4-准备工作" class="hash-link" aria-label="4. 准备工作的直接链接" title="4. 准备工作的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-配置-rocky-linux-9-虚拟机">4.1 配置 Rocky Linux 9 虚拟机<a href="#41-配置-rocky-linux-9-虚拟机" class="hash-link" aria-label="4.1 配置 Rocky Linux 9 虚拟机的直接链接" title="4.1 配置 Rocky Linux 9 虚拟机的直接链接">​</a></h3>
<ul>
<li>
<p>你可以使用任何平台来创建虚拟机或容器：</p>
<ul>
<li>
<p><strong>AWS EC2</strong>：这些步骤已在 Rocky-9-EC2-Base-9.5-20241118.0.x86_64 AMI 上验证过，但应该适用于任何 Rocky Linux 9 的版本  。</p>
</li>
<li>
<p><strong>VirtualBox</strong>：可以使用官方的 Rocky Linux 9 ISO 或 Vagrant 镜像。</p>
</li>
<li>
<p><strong>Docker</strong>：这些步骤已在 <code>rockylinux/rockylinux:9</code> 镜像上验证过，但应该适用于任何基于 Rocky Linux 9 的容器。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">docker run -it --shm-size=2gb -h cdw rockylinux/rockylinux:9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里的主机名 &quot;cdw&quot;（协调数据仓库）只是我们在测试时给容器起的一个示例名字。</p>
<p>为了确保测试套件能够顺利运行，你可能需要通过 <code>--shm-size=2gb</code> 参数来增加容器的共享内存。如果 Cloudberry 集群没有足够的共享内存资源，测试可能会失败。</p>
</li>
<li>
<p><strong>其他云平台</strong>：使用等效的 Rocky Linux 9 镜像。</p>
</li>
</ul>
</li>
<li>
<p>确保虚拟机或容器具备以下条件：</p>
<ul>
<li>能够连接互联网，以便安装软件包。</li>
<li>可以通过 SSH 或控制台进行用户交互。</li>
<li>有足够的资源  （CPU、内存和存储空间），以满足开发环境的需求。</li>
</ul>
</li>
</ul>
<p>:::说明
由于不同平台的环境配置步骤各不相同，本指南没有涵盖具体步骤。本指南假设你已经成功创建了虚拟机或容器，并且能够以默认用户身份登录（例如，在 AWS 上的 Rocky Linux 使用 <code>rocky</code> 用户）。
:::</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-系统要求">4.2 系统要求<a href="#42-系统要求" class="hash-link" aria-label="4.2 系统要求的直接链接" title="4.2 系统要求的直接链接">​</a></h3>
<p>开发环境的最低要求如下：</p>
<ul>
<li>CPU：建议 4 核（最低 2 核）</li>
<li>内存：建议 8GB（最低 4GB）</li>
<li>存储：建议有 20GB 的可用空间</li>
<li>网络：需要宽带互联网连接，用于下载软件包</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-安装-sudo如果尚未安装">4.3 安装 <code>sudo</code>（如果尚未安装）<a href="#43-安装-sudo如果尚未安装" class="hash-link" aria-label="43-安装-sudo如果尚未安装的直接链接" title="43-安装-sudo如果尚未安装的直接链接">​</a></h3>
<p>如果系统中尚未安装 <code>sudo</code>，请运行以下命令进行安装：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">dnf install -y sudo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>:::说明
在 Docker 等环境中，安装 <code>sudo</code> 后，<code>root</code> 用户可以在无需密码提示的情况下使用 <code>sudo</code>。
:::</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-安装所需软件包">4.4 安装所需软件包<a href="#44-安装所需软件包" class="hash-link" aria-label="4.4 安装所需软件包的直接链接" title="4.4 安装所需软件包的直接链接">​</a></h3>
<p>本步骤将安装构建 Apache Cloudberry 所需的基本开发工具、库和依赖项。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="441-安装基本系统软件包">4.4.1 安装基本系统软件包<a href="#441-安装基本系统软件包" class="hash-link" aria-label="4.4.1 安装基本系统软件包的直接链接" title="4.4.1 安装基本系统软件包的直接链接">​</a></h4>
<p>以下命令将安装 Cloudberry 开发所需的主要软件包：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo dnf install -y apr-devel autoconf bison bzip2 bzip2-devel cmake3 createrepo_c ed flex gcc gcc-c++ git glibc-langpack-en initscripts iproute java-11-openjdk java-11-openjdk-devel krb5-devel less libcurl-devel libevent-devel libuuid-devel libxml2-devel libzstd-devel lz4 lz4-devel m4 nc net-tools openldap-devel openssh-clients openssh-server openssl-devel pam-devel passwd perl perl-Env perl-ExtUtils-Embed perl-Test-Simple perl-core pinentry python3-devel python3-lxml python3-psutil python3-pytest python3-pyyaml readline-devel rpm-build rpm-sign rpmdevtools rsync tar unzip util-linux-ng wget which zlib-devel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="442-安装-codeready-builder-crb-软件包">4.4.2 安装 CodeReady Builder (CRB) 软件包<a href="#442-安装-codeready-builder-crb-软件包" class="hash-link" aria-label="4.4.2 安装 CodeReady Builder (CRB) 软件包的直接链接" title="4.4.2 安装 CodeReady Builder (CRB) 软件包的直接链接">​</a></h4>
<p>CRB 仓库提供了额外的开发工具和库。在 Rocky Linux 上，该仓库默认处于禁用状态，需要手动启用。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo dnf install -y --enablerepo=crb libuv-devel libyaml-devel perl-IPC-Run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>在红帽企业版 Linux (RHEL) 中，此仓库被称为 &quot;PowerTools&quot;。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-创建并配置-gpadmin-用户">4.5 创建并配置 <code>gpadmin</code> 用户<a href="#45-创建并配置-gpadmin-用户" class="hash-link" aria-label="45-创建并配置-gpadmin-用户的直接链接" title="45-创建并配置-gpadmin-用户的直接链接">​</a></h3>
<p>为了准备 Apache Cloudberry（孵化中）的开发环境，我们需要创建并配置一个专用的 <code>gpadmin</code> 用户。</p>
<ol>
<li>
<p>创建一个名为 <code>gpadmin</code> 的用户，同时创建同名用户组、主目录，并设置 bash 为默认 shell：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo useradd -U -m -s /bin/bash gpadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>授予 <code>gpadmin</code> 用户无需密码的 sudo 访问权限：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">echo &#x27;gpadmin ALL=(ALL) NOPASSWD:ALL&#x27; | sudo tee /etc/sudoers.d/90-gpadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>验证 <code>gpadmin</code> 用户的设置：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo -u gpadmin sudo whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果输出为 <code>root</code>，则表明配置正确。</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="451-设置-gpadmin-用户环境">4.5.1 设置 <code>gpadmin</code> 用户环境<a href="#451-设置-gpadmin-用户环境" class="hash-link" aria-label="451-设置-gpadmin-用户环境的直接链接" title="451-设置-gpadmin-用户环境的直接链接">​</a></h4>
<p>可选步骤：通过配置 Vim、Tmux 和 Oh My Bash 来增强 <code>gpadmin</code> 的开发环境</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo dnf install -y vim tmux</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo -u gpadmin bash &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 设置 Vim 配置</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">wget -nv -q https://gist.githubusercontent.com/simonista/8703722/raw/d08f2b4dc10452b97d3ca15386e9eed457a53c61/.vimrc -O /home/gpadmin/.vimrc</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 设置 Tmux 配置</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">wget -nv -q https://raw.githubusercontent.com/tony/tmux-config/master/.tmux.conf -O /home/gpadmin/.tmux.conf</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 安装 Oh My Bash</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/ohmybash/oh-my-bash/master/tools/install.sh )&quot; --unattended</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="452-必要的配置">4.5.2 必要的配置<a href="#452-必要的配置" class="hash-link" aria-label="4.5.2 必要的配置的直接链接" title="4.5.2 必要的配置的直接链接">​</a></h4>
<p>该脚本以 <code>gpadmin</code> 用户身份执行三项主要任务：</p>
<ul>
<li>更新 <code>.bashrc</code>，引入 Cloudberry 环境变量。</li>
<li>设置 SSH 密钥对，实现免密登录（如果尚未存在）。</li>
<li>配置 SSH 目录的正确权限，确保安全。</li>
</ul>
<p>脚本通过 heredoc（EOF）块在 <code>gpadmin</code> 用户上下文中执行多个命令。在这些说明中会多次用到这种方法。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo -u gpadmin bash &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 将 Cloudberry 环境设置添加到 .bashrc</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">echo -e &#x27;\n</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 添加 Cloudberry 条目</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">if [ -f /usr/local/cloudberry-db/greenplum_path.sh ]; then</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  source /usr/local/cloudberry-db/greenplum_path.sh</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 使用 UTF-8 编码的美式英语</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">export LANG=en_US.UTF-8</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">&#x27; &gt;&gt; /home/gpadmin/.bashrc</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 设置 SSH 以实现免密访问</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">mkdir -p /home/gpadmin/.ssh</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">if [ ! -f /home/gpadmin/.ssh/id_rsa ]; then</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  ssh-keygen -t rsa -b 2048 -C &#x27;apache-cloudberry-dev&#x27; -f /home/gpadmin/.ssh/id_rsa -N &quot;&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">cat /home/gpadmin/.ssh/id_rsa.pub &gt;&gt; /home/gpadmin/.ssh/authorized_keys</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 设置 SSH 目录的正确权限</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">chmod 700 /home/gpadmin/.ssh</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">chmod 600 /home/gpadmin/.ssh/authorized_keys</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">chmod 644 /home/gpadmin/.ssh/id_rsa.pub</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="46-配置系统设置">4.6 配置系统设置<a href="#46-配置系统设置" class="hash-link" aria-label="4.6 配置系统设置的直接链接" title="4.6 配置系统设置的直接链接">​</a></h3>
<p>像 Apache Cloudberry 这样的数据库系统需要特定的系统资源限制才能高效运行。这些限制应针对运行数据库进程的 <code>gpadmin</code> 用户进行配置。</p>
<ol>
<li>
<p>创建资源限制配置</p>
<p>创建用户限制配置文件：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo tee /etc/security/limits.d/90-db-limits.conf &lt;&lt; &#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 为 gpadmin 设  置核心转储文件大小限制</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin soft core unlimited</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin hard core unlimited</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 为 gpadmin 设置打开文件限制</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin soft nofile 524288</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin hard nofile 524288</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 为 gpadmin 设置进程限制</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin soft nproc 131072</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpadmin hard nproc 131072</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>了解以下这些限制。</p>
<p>配置设置了以下类型的资源限制：</p>
<ul>
<li>
<p><strong>核心转储</strong> (<code>core</code>)：</p>
<ul>
<li>设置为 <code>unlimited</code>，启用完整的内核转储。</li>
<li>对调试和故障排除至关重要。</li>
<li>软限制和硬限制均不受限 制。</li>
</ul>
</li>
<li>
<p><strong>打开文件</strong> (<code>nofile</code>)：</p>
<ul>
<li>设置为 <code>524288</code>（512K）个文件。</li>
<li>用于处理大量的并发数据库连接。</li>
<li>对分布式操作和大型工作负载至关重要。</li>
</ul>
</li>
<li>
<p><strong>进程限制</strong> (<code>nproc</code>)：</p>
<ul>
<li>设置为 <code>131072</code>（128K）个进程。</li>
<li>支持并行查询执行。</li>
<li>支持 Cloudberry 的分布式架构。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>验证资源限制。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 检查当前限制</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo -u gpadmin ulimit -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-获取并编译软件">5. 获取并编译软件<a href="#5-获取并编译软件" class="hash-link" aria-label="5. 获取并编译软件的直接链接" title="5. 获取并编译软件的直接链接">​</a></h2>
<p>从这一步开始，我们将以 <code>gpadmin</code> 用户身份执行命令。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo su - gpadmin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-下载构建并安装-apache-xerces-c">5.1 下载、构建并安装 Apache Xerces-C<a href="#51-下载构建并安装-apache-xerces-c" class="hash-link" aria-label="5.1 下载、构建并安装 Apache Xerces-C的直接链接" title="5.1 下载、构建并安装 Apache Xerces-C的直接链接">​</a></h3>
<p>Apache Xerces-C 是 Cloudberry 启用 Orca 查询优化器的必需依赖项。以下步骤将下载源代码，验证其完整性，构建库并完成安装。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="511-设置变量辅助">5.1.1 设置变量（辅助）<a href="#511-设置变量辅助" class="hash-link" aria-label="5.1.1 设置变量（辅助）的直接链接" title="5.1.1 设置变量（辅助）的直接链接">​</a></h4>
<p>为了简化命令并提高可复用性，我们定义以下辅助变量：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">XERCES_LATEST_RELEASE=3.3.0</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">XERCES_INSTALL_PREFIX=&quot;/usr/local/xerces-c&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>这些变量用于指定要安装的 Apache Xerces-C 的版本（<code>XERCES_LATEST_RELEASE</code>）及其安装路径  （<code>XERCES_INSTALL_PREFIX</code>），确保整个构建过程的一致性并简化命令。</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="512-下载并验证源代码包">5.1.2 下载并验证源代码包<a href="#512-下载并验证源代码包" class="hash-link" aria-label="5.1.2 下载并验证源代码包的直接链接" title="5.1.2 下载并验证源代码包的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">wget -nv &quot;https://dlcdn.apache.org//xerces/c/3/sources/xerces-c-${XERCES_LATEST_RELEASE}.tar.gz&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">echo &quot;$(curl -sL https://dlcdn.apache.org//xerces/c/3/sources/xerces-c-${XERCES_LATEST_RELEASE}.tar.gz.sha256)&quot; | sha256sum -c -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>请确保 SHA-256 校验通过（输出应为：<code>xerces-c-3.3.0.tar.gz: OK</code>）。如果校验失败，请不要继续，需验证源代码包的完整性。</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="513-解压配置构建测试和安装">5.1.3 解压、配置、构建、测试和安装<a href="#513-解压配置构建测试和安装" class="hash-link" aria-label="5.1.3 解压、配置、构建、测试和安装的直接链接" title="5.1.3 解压、配置、构建、测试和安装的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">tar xf &quot;xerces-c-${XERCES_LATEST_RELEASE}.tar.gz&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">rm &quot;xerces-c-${XERCES_LATEST_RELEASE}.tar.gz&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">cd xerces-c-${XERCES_LATEST_RELEASE}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">./configure --prefix=&quot;${XERCES_INSTALL_PREFIX}-${XERCES_LATEST_RELEASE}&quot; | tee configure-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make -j$(nproc) | tee make-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make check | tee make-check-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo make install | tee make-install-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo ln -s ${XERCES_INSTALL_PREFIX}-${XERCES_LATEST_RELEASE} ${XERCES_INSTALL_PREFIX}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><ul>
<li><code>make</code> 命令以并行方式运行（<code>-j$(nproc)</code>），利用所有可用的 CPU 核心加速构建过程。<code>nproc</code> 命令动态获取核心数量。</li>
<li>在 <code>make check</code> 阶段，标记为 <strong>XFAIL</strong>（预期失败）的测试结果是可以接受的，不代表构建存在问题。</li>
<li>命令的输出被保存到带时间戳的日志文件中，方便日后参考或故障排查。</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-克隆-apache-cloudberry-仓库">5.2 克隆 Apache Cloudberry 仓库<a href="#52-克隆-apache-cloudberry-仓库" class="hash-link" aria-label="5.2 克隆 Apache Cloudberry 仓库的直接链接" title="5.2 克隆 Apache Cloudberry 仓库的直接链接">​</a></h3>
<p>将 Apache Cloudberry 的源代码克隆到 <code>gpadmin</code> 用户的主目录中：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">git clone https://github.com/apache/cloudberry.git ~/cloudberry</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">cd ~/cloudberry</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-配置构建过程">5.3 配置构建过程<a href="#53-配置构建过程" class="hash-link" aria-label="5.3 配置构建过程的直接链接" title="5.3 配置构建过程的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="531-准备环境">5.3.1 准备环境<a href="#531-准备环境" class="hash-link" aria-label="5.3.1 准备环境的直接链接" title="5.3.1 准备环境的直接链接">​</a></h4>
<p>构建过程需要在指定位置准备好必要的库（例如 Xerces-C），以便进行配置和运行。使用以下命令来准备环境：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo rm -rf /usr/local/cloudberry-db</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo chmod a+w /usr/local</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">mkdir -p /usr/local/cloudberry-db/lib</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo cp -v /usr/local/xerces-c/lib/libxerces-c.so \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           /usr/local/xerces-c/lib/libxerces-c-3.*.so \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           /usr/local/cloudberry-db/lib</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">sudo chown -R gpadmin.gpadmin /usr/local/cloudberry-db</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="532-运行-configure">5.3.2 运行 <code>configure</code><a href="#532-运行-configure" class="hash-link" aria-label="532-运行-configure的直接链接" title="532-运行-configure的直接链接">​</a></h4>
<p><code>configure</code> 命令用于设置 Apache Cloudberry 的构建环境，包括多个开发功能和扩展。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">cd ~/cloudberry</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">export LD_LIBRARY_PATH=/usr/local/cloudberry-db/lib:$LD_LIBRARY_PATH</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">./configure --prefix=/usr/local/cloudberry-db \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --disable-external-fts \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-debug \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-cassert \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-debug-extensions \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-gpcloud \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-ic-proxy \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-mapreduce \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-orafce \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-orca \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-pxf \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --enable-tap-tests \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-gssapi \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-ldap \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-libxml \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-lz4 \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-openssl \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-pam \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-perl \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-pgport=5432 \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-python \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-pythonsrc-ext \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-ssl=openssl \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-openssl \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-uuid=e2fs \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-includes=/usr/local/xerces-c/include \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            --with-libraries=/usr/local/cloudberry-db/lib | tee ~/cloudberry/configure-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p><code>configure</code> 命令的输出被保存到带时间戳的日志文件中，方便日后参考或故障排查。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-构建并安装-apache-cloudberry-及其-contrib-扩展">5.4 构建并安装 Apache Cloudberry 及其 contrib 扩展<a href="#54-构建并安装-apache-cloudberry-及其-contrib-扩展" class="hash-link" aria-label="5.4 构建并安装 Apache Cloudberry 及其 contrib 扩展的直接链接" title="5.4 构建并安装 Apache Cloudberry 及其 contrib 扩展的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="541-编译代码">5.4.1 编译代码<a href="#541-编译代码" class="hash-link" aria-label="5.4.1 编译代码的直接链接" title="5.4.1 编译代码的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 使用以下命令编译 Apache Cloudberry 的核心组件：</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make -j$(nproc) --directory=~/cloudberry | tee ~/cloudberry/make-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 编译额外的 contrib 模块，这些模块提供了可选功能和扩展：</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make -j$(nproc) --directory=~/cloudberry/contrib | tee ~/cloudberry/make-contrib-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="542-安装编译后的二进制文件">5.4.2 安装编译后的二进制文件<a href="#542-安装编译后的二进制文件" class="hash-link" aria-label="5.4.2 安装编译后的二进制文件的直接链接" title="5.4.2 安装编译后的二进制文件的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 将核心组件安装到指定目录：</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make install --directory=~/cloudberry | tee ~/cloudberry/make-install-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 将 contrib 模块安装到指定目录：</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">make install --directory=~/cloudberry/contrib | tee ~/cloudberry/make-contrib-install-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="55-验证安装">5.5 验证安装<a href="#55-验证安装" class="hash-link" aria-label="5.5 验证安装的直接链接" title="5.5 验证安装的直接链接">​</a></h3>
<p>安装完成后，通过以下步骤验证安装是否成功：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="551-检查-cloudberry-版本">5.5.1 检查 Cloudberry 版本<a href="#551-检查-cloudberry-版本" class="hash-link" aria-label="5.5.1 检查 Cloudberry 版本的直接链接" title="5.5.1 检查 Cloudberry 版本的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">/usr/local/cloudberry-db/bin/postgres --gp-version</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/usr/local/cloudberry-db/bin/postgres --version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="552-验证库依赖">5.5.2 验证库依赖<a href="#552-验证库依赖" class="hash-link" aria-label="5.5.2 验证库依赖的直接链接" title="5.5.2 验证库依赖的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ldd /usr/local/cloudberry-db/bin/postgres</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="553-检查库扩展">5.5.3 检查库扩展<a href="#553-检查库扩展" class="hash-link" aria-label="5.5.3 检查库扩展的直接链接" title="5.5.3 检查库扩展的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ls -al /usr/local/cloudberry-db/share/postgresql/extension</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="554-检查核心工具">5.5.4 检查核心工具<a href="#554-检查核心工具" class="hash-link" aria-label="5.5.4 检查核心工具的直接链接" title="5.5.4 检查核心工具的直接链接">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ls -l /usr/local/cloudberry-db/bin/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>预期输出应包含关键二进制文件，如 postgres 和 initdb 等。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="56-常见问题">5.6 常见问题<a href="#56-常见问题" class="hash-link" aria-label="5.6 常见问题的直接链接" title="5.6 常见问题的直接链接">​</a></h3>
<ul>
<li>
<p><strong>配置失败，提示缺少依赖项：</strong></p>
<ol>
<li>确认所有必需的软件包是否已正确安装。</li>
<li>查看配置日志文件，了解具体的错误信息。</li>
<li>确保 CRB 仓库已启用且配置正确。</li>
</ol>
</li>
<li>
<p><strong>构建失败，提示编译错误：</strong></p>
<ol>
<li>查看 make 日志，定位具体的错误信息。</li>
<li>确保系统有足够的资源（如内存和 CPU）。</li>
<li>验证 Xerces-C 是否安装正确。</li>
</ol>
</li>
<li>
<p><strong>库加载问题：</strong></p>
<ol>
<li>确保 <code>LD_LIBRARY_PATH</code> 包含所需的库目录。</li>
<li>检查库文件的权限设置。</li>
</ol>
</li>
</ul>
<p>如果需要更详细的错误信息，可以查看安装过程中生成的带时间戳的日志文件。</p>
<p>至此，您已在 Rocky Linux 9 上成功构建并安装了 Apache Cloudberry，安装目录为 <code>/usr/local/cloudberry-db</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-设置-cloudberry-开发集群">6. 设置 Cloudberry 开发集群<a href="#6-设置-cloudberry-开发集群" class="hash-link" aria-label="6. 设置 Cloudberry 开发集群的直接链接" title="6. 设置 Cloudberry 开发集群的直接链接">​</a></h2>
<p>本节将指导你搭建一个 Cloudberry 演示集群，并测试其基本功能。该演示集群包含一个 Coordinator、一个备用 Coordinator 以及多个主 Segment 和镜像 Segment，所有这些组件都运行在同一台开发主机上。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-设置初始容器并非所有环境都需要">6.1 设置初始容器（并非所有环境都需要）<a href="#61-设置初始容器并非所有环境都需要" class="hash-link" aria-label="6.1 设置初始容器（并非所有环境都需要）的直接链接" title="6.1 设置初始容器（并非所有环境都需要）的直接链接">​</a></h3>
<p>容器环境通常不会默认启动 SSH 服务。由于 Cloudberry 高度依赖 SSH 进行进程间通信，因此我们需要手动初始化并启动 SSH 服务：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">if ! pgrep sshd &gt; /dev/null; then</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    echo &quot;SSH 服务未运行，正在启动...&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    sudo ssh-keygen -A</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    echo &quot;PasswordAuthentication yes&quot; | sudo tee -a /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    sudo /usr/sbin/sshd</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    echo &quot;SSH 服务已在运行&quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">fi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-为-cloudberry-配置-ssh">6.2 为 Cloudberry 配置 SSH<a href="#62-为-cloudberry-配置-ssh" class="hash-link" aria-label="6.2 为 Cloudberry 配置 SSH的直接链接" title="6.2 为 Cloudberry 配置 SSH的直接链接">​</a></h3>
<p>Cloudberry 使用 SSH 进行 Coordinator 与 Segment 之间的通信。以下命令将确保为 <code>gpadmin</code> 用户正确配置 SSH，通过将主机添加到 <code>known_hosts</code> 文件并验证 SSH 连接：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ssh-keyscan $(hostname) &gt;&gt; ~/.ssh/known_hosts</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">ssh $(hostname) date</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-设置-cloudberry-环境变量">6.3 设置 Cloudberry 环境变量<a href="#63-设置-cloudberry-环境变量" class="hash-link" aria-label="6.3 设置 Cloudberry 环境变量的直接链接" title="6.3 设置 Cloudberry 环境变量的直接链接">​</a></h3>
<p>加载 Cloudberry 环境变量，这些变量会设置二进制文件、库和其他关键组件的路径：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">source /usr/local/cloudberry-db/greenplum_path.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-创建开发集群">6.4 创建开发集群<a href="#64-创建开发集群" class="hash-link" aria-label="6.4 创建开发集群的直接链接" title="6.4 创建开发集群的直接链接">​</a></h3>
<p>创建一个演示集群，该集群在单台机器上模拟完整的 Cloudberry 部署。这包括 1 个 Coordinator、1 个备用 Coordinator、3 个主 Segment 和 3 个镜像 Segment：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">make create-demo-cluster --directory=~/cloudberry | tee ~/cloudberry/make-create-demo-cluster-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="65-配置集群环境">6.5 配置集群环境<a href="#65-配置集群环境" class="hash-link" aria-label="6.5 配置集群环境的直接链接" title="6.5 配置集群环境的直接链接">​</a></h3>
<p>创建集群后，验证并加载指向 Coordinator 端口和数据目录的集群特定变量：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">source ~/cloudberry/gpAux/gpdemo/gpdemo-env.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="66-验证集群部署">6.6 验证集群部署<a href="#66-验证集群部署" class="hash-link" aria-label="6.6 验证集群部署的直接链接" title="6.6 验证集群部署的直接链接">​</a></h3>
<p>运行以下命令，确保集群正常运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 显示详细的集群状态，包括 Segment 的状态</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpstate</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 测试集群的关闭和启动</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpstop -a</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpstart -a</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 查看 Cloudberry 的版本和构建信息</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql template1 -c &#x27;SELECT version()&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 查看 Segment 配置，显示主 Segment 和镜像 Segment 的关系</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql template1 -c &#x27;SELECT * from gp_segment_configuration&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 查看可用的 PostgreSQL 扩展</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql template1 -c &#x27;SELECT * FROM pg_available_extensions&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="67-扩展测试示例pg_stat_statements">6.7 扩展测试示例：pg_stat_statements<a href="#67-扩展测试示例pg_stat_statements" class="hash-link" aria-label="6.7 扩展测试示例：pg_stat_statements的直接链接" title="6.7 扩展测试示例：pg_stat_statements的直接链接">​</a></h3>
<p>以下示例展示了如何启用和测试 <code>pg_stat_statements</code> 扩展，该扩展可提供 SQL 查询执行的统计信息：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 创建一个用于测试的数据库</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">createdb gpadmin</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 将扩展添加到共享库中以启用它</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">echo &quot;shared_preload_libraries=&#x27;pg_stat_statements&#x27;&quot; &gt;&gt; $COORDINATOR_DATA_DIRECTORY/postgresql.conf</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 重启集群以加载新库（-r 表示“重启”）</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">gpstop -ar</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 在数据库中创建扩展</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql gpadmin -e -c &#x27;CREATE EXTENSION pg_stat_statements&#x27;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 运行测试查询以生成统计信息</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql gpadmin --echo-queries &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">-- 创建一个示例表</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">CREATE TABLE employees (</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    id SERIAL PRIMARY KEY,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    name TEXT,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    department TEXT,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    salary NUMERIC</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">-- 插入示例数据</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">INSERT INTO employees (name, department, salary)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">VALUES</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">(&#x27;Alice&#x27;, &#x27;HR&#x27;, 60000),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">(&#x27;Bob&#x27;, &#x27;Engineering&#x27;, 80000),</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">(&#x27;Charlie&#x27;, &#x27;Marketing&#x27;, 70000);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">-- 查询数据以生成统计信息</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">SELECT * FROM employees WHERE department = &#x27;Engineering&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">SELECT AVG(salary) FROM employees;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">-- 查看调用次数最多的查询</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">SELECT query, calls, total_exec_time AS total_time, rows</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">FROM pg_stat_statements</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">ORDER BY calls DESC</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">LIMIT 5;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">-- 查看耗时最长的查询</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">SELECT query, calls, total_exec_time AS total_time, rows</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">FROM pg_stat_statements</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">ORDER BY total_exec_time DESC</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">LIMIT 5;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="68-清理开发集群">6.8 清理开发集群<a href="#68-清理开发集群" class="hash-link" aria-label="6.8 清理开发集群的直接链接" title="6.8 清理开发集群的直接链接">​</a></h3>
<p>如果需要清理环境并重新开始，可以销毁演示集群：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">make destroy-demo-cluster --directory=~/cloudberry | tee ~/cloudberry/make-destroy-demo-cluster-$(date &quot;+%Y.%m.%d-%H.%M.%S&quot;).log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此命令会清除所有集群数据和配置，方便你按需创建一个全新的干净集群。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="69-解决-ssh-连接问题">6.9 解决 SSH 连接问题<a href="#69-解决-ssh-连接问题" class="hash-link" aria-label="6.9 解决 SSH 连接问题的直接链接" title="6.9 解决 SSH 连接问题的直接链接">​</a></h3>
<p>运行 <code>create-demo-cluster</code> 时，若 SSH 主机验证未完成，进程可能会卡住，表现为等待用户输入以确认主机身份的停滞状态。</p>
<p>因此，在创建集群前，需运行以下命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">ssh-keyscan $(hostname) &gt;&gt; ~/.ssh/known_hosts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该命令会自动将主机的 SSH 密钥添加到 <code>known_hosts</code> 文件，避免在创建集群时出现交互式提示。</p>
<p>如果仍遇到 SSH 问题，可按以下步骤排查：</p>
<ol>
<li>确保 SSH 守护进程正在运行。</li>
<li>检查 <code>known_hosts</code> 文件是否存在且权限正确。</li>
<li>在创建集群前，通过 <code>ssh $(hostname) date</code> 测试 SSH 连接。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-验证基本功能">7. 验证基本功能<a href="#7-验证基本功能" class="hash-link" aria-label="7. 验证基本功能的直接链接" title="7. 验证基本功能的直接链接">​</a></h2>
<p>运行 installcheck 测试套件验证基本功能。建议分别在启用和禁用 Orca（查询优化器）的情况下进行测试：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 启用 Orca 优化器运行测试</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">PGOPTIONS=&#x27;-c optimizer=on&#x27; make --directory=~/cloudberry installcheck</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"># 禁用 Orca 优化器运行测试</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">PGOPTIONS=&#x27;-c optimizer=off&#x27; make --directory=~/cloudberry installcheck</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>尽管 Orca 是 Cloudberry 的默认优化器，但在运行 installcheck 时，需明确设置 <code>optimizer=on</code>，否则 <code>explain</code> 测试会因缺少显式配置选项而失败。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-测试结果">7.1 测试结果<a href="#71-测试结果" class="hash-link" aria-label="7.1 测试结果的直接链接" title="7.1 测试结果的直接链接">​</a></h3>
<p>installcheck 测试用于检查基本功能是否正常。执行时，你会看到类似以下的输出：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">test tablespace                   ... ok         3236 ms (diff   76 ms)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">parallel group (20 tests):  pg_lsn oid txid name char varchar int2 regproc text ...</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     boolean                      ... ok          862 ms (diff   56 ms)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     char                         ... ok          419 ms (diff   87 ms)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     explain                      ... FAILED      310 ms (diff  139 ms)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行完成后，会显示一个总结，例如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">========================</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> 1 of 658 tests failed. </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">========================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果某些测试失败了：</p>
<ul>
<li><code>regression.diffs</code> 文件会显示实际结果与预期结果之间的差异。</li>
<li><code>regression.out</code> 文件包含完整的测试执行输出。</li>
</ul>
<p>这些文件位于 <code>/home/gpadmin/cloudberry/src/test/regress/</code> 目录中。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>installcheck 只是众多可用测试计划中的一个。本指南主要关注基本开发环境的搭建和验证。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-排查测试失败">7.2 排查测试失败<a href="#72-排查测试失败" class="hash-link" aria-label="7.2 排查测试失败的直接链接" title="7.2 排查测试失败的直接链接">​</a></h3>
<p>如果测试失败，你可能需要查看各个集群组件的日志文件。可以通过查询 Segment 配置来定位包含这些日志的数据目录：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">psql -P pager=off template1 -c &#x27;SELECT * from gp_segment_configuration&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此命令会显示完整的集群配置信息。其中，<code>content = -1</code> 表示 Coordinator 节点：</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain"> dbid </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> content </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> role </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> preferred_role </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">mode</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">status</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> port </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> hostname </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> address </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">                                  datadir                                   </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> warehouseid </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#8292a2;font-style:italic">------+---------+------+----------------+------+--------+------+----------+---------+----------------------------------------------------------------------------+-------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">1</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">      </span><span class="token operator" style="color:#66d9ef">-</span><span class="token number" style="color:#ae81ff">1</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> n    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7000</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">qddir</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir</span><span class="token operator" style="color:#66d9ef">-</span><span class="token number" style="color:#ae81ff">1</span><span class="token plain">         </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">8</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">      </span><span class="token operator" style="color:#66d9ef">-</span><span class="token number" style="color:#ae81ff">1</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7001</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">standby                     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">2</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7002</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast1</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir0        </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">5</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7005</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast_mirror1</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir0 </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">3</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">1</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7003</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast2</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir1        </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">6</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">1</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7006</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast_mirror2</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir1 </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">4</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">2</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> p              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7004</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast3</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir2        </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token number" style="color:#ae81ff">7</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">       </span><span class="token number" style="color:#ae81ff">2</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> m              </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> s    </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> u      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token number" style="color:#ae81ff">7007</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw      </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> mdw     </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">home</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpadmin</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">cloudberry</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpAux</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">gpdemo</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">datadirs</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">dbfast_mirror3</span><span class="token operator" style="color:#66d9ef">/</span><span class="token plain">demoDataDir2 </span><span class="token operator" style="color:#66d9ef">|</span><span class="token plain">           </span><span class="token number" style="color:#ae81ff">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>每个 <code>datadir</code>  目录中都包含有助于诊断测试失败的日志文件。可以根据失败的测试，在相应组件的目录中查看这些日志。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/cloudberry-site/edit/main/i18n/zh/docusaurus-plugin-content-docs/version-1.x/cbdb-rockylinux9-compile.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">最后<!-- -->由 <b>Dianjin Wang</b> <!-- -->于 <b><time datetime="2025-08-26T06:19:28.000Z">2025年8月26日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/1.x/cbdb-rockylinux8-ubuntu-compile"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label single-line-overflow hide-before-after">在 Rocky Linux 8 和 Ubuntu 上</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/1.x/cbdb-op-software-hardware"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label single-line-overflow hide-before-after">软硬件配置需求</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-目标受众" class="table-of-contents__link toc-highlight">1. 目标受众</a></li><li><a href="#2-构建-apache-cloudberry-的过程" class="table-of-contents__link toc-highlight">2. 构建 Apache Cloudberry 的过程</a></li><li><a href="#3-cloudberry-与-postgresql-的主要区别" class="table-of-contents__link toc-highlight">3. Cloudberry 与 PostgreSQL 的主要区别</a></li><li><a href="#4-准备工作" class="table-of-contents__link toc-highlight">4. 准备工作</a></li><li><a href="#5-获取并编译软件" class="table-of-contents__link toc-highlight">5. 获取并编译软件</a></li><li><a href="#6-设置-cloudberry-开发集群" class="table-of-contents__link toc-highlight">6. 设置 Cloudberry 开发集群</a></li><li><a href="#7-验证基本功能" class="table-of-contents__link toc-highlight">7. 验证基本功能</a></li></ul></div></div></div></div></main></div></div></div><div class="wrap_QlFE"><div class="mainWrap_IbWk"><div class="linksWrap_Zcc4"><div><div class="footerLinkTitle_PxTg">Support</div><div class="footerLinkItem_Kf4k"><a href="https://github.com/apache/cloudberry/issues" target="_blank" rel="noopener noreferrer">GitHub Issues</a></div><div class="footerLinkItem_Kf4k"><a href="https://github.com/apache/cloudberry/discussions" target="_blank" rel="noopener noreferrer">GitHub Discussions</a></div><div class="footerLinkItem_Kf4k"><a href="https://inviter.co/apache-cloudberry" target="_blank" rel="noopener noreferrer">Slack</a></div><div class="footerLinkItem_Kf4k"><a href="https://x.com/ASFCloudberry" target="_blank" rel="noopener noreferrer">Twitter</a></div><div class="footerLinkItem_Kf4k"><a href="https://youtube.com/@ApacheCloudberry" target="_blank" rel="noopener noreferrer">Youtube</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/community/security">Security</a></div></div><div><div class="footerLinkTitle_PxTg">Resources</div><div class="footerLinkItem_Kf4k"><a href="/zh/releases" target="_blank">Download</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/docs/">Documentation</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/community/events">Events</a></div><div class="footerLinkItem_Kf4k"><a href="/zh/community/brand" target="_blank">Brand Guidelines</a></div></div><div><div class="footerLinkTitle_PxTg">Contribution</div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/git">Working with Git &amp; GitHub</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/how-to-contribute">Contribution Overview</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/code">Code Contribution</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/doc">Doc Contribution</a></div></div></div><div class="logoLinkWrap_MDp5"><div class="logoWrap_qcVI"><img class="logo_cphB" src="/zh/img/apache-incubator.svg" alt=""></div><div class="links_yA93"><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M15.002 0c-8.288 0-15 6.713-15 15 0 6.637 4.293 12.244 10.256 14.231.75.131 1.031-.319 1.031-.712 0-.356-.019-1.538-.019-2.794-3.769.694-4.744-.919-5.044-1.763-.168-.43-.9-1.762-1.537-2.118-.525-.282-1.275-.975-.019-.994 1.181-.019 2.025 1.087 2.306 1.537 1.35 2.27 3.507 1.632 4.37 1.238.13-.975.524-1.631.956-2.006-3.338-.375-6.826-1.669-6.826-7.406 0-1.632.582-2.982 1.538-4.032-.15-.375-.675-1.912.15-3.975 0 0 1.256-.394 4.125 1.538 1.2-.338 2.475-.506 3.75-.506s2.55.168 3.75.506c2.869-1.95 4.125-1.538 4.125-1.538.825 2.063.3 3.6.15 3.975.956 1.05 1.538 2.382 1.538 4.032 0 5.756-3.507 7.03-6.844 7.406.544.468 1.012 1.369 1.012 2.775 0 2.006-.018 3.619-.018 4.125 0 .394.28.862 1.03.712A15.024 15.024 0 0 0 30.003 15c0-8.287-6.713-15-15-15Z"></path></svg><svg width="32" height="26" viewBox="0 0 32 26" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M31.319 3.484c-1.145.507-2.36.84-3.603.987a6.293 6.293 0 0 0 2.758-3.47 12.518 12.518 0 0 1-3.983 1.52A6.274 6.274 0 0 0 15.64 6.815c0 .493.056.97.161 1.43a17.811 17.811 0 0 1-12.93-6.555 6.252 6.252 0 0 0-.85 3.154 6.272 6.272 0 0 0 2.791 5.222 6.253 6.253 0 0 1-2.841-.785l-.001.077a6.277 6.277 0 0 0 5.033 6.153 6.305 6.305 0 0 1-2.834.108 6.278 6.278 0 0 0 5.86 4.356 12.59 12.59 0 0 1-7.79 2.686c-.5 0-1-.03-1.497-.088a17.746 17.746 0 0 0 9.616 2.818c11.54 0 17.849-9.559 17.849-17.848 0-.272-.007-.544-.019-.812a12.746 12.746 0 0 0 3.13-3.246Z"></path></svg><svg width="30" height="24" viewBox="0 0 30 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M15.366 0c.801.004 2.805.024 4.935.11l.755.032c2.145.102 4.287.275 5.35.571 1.417.398 2.53 1.56 2.907 3.033.6 2.339.675 6.903.684 8.008l.002.229v.032l-.002.229c-.009 1.104-.084 5.669-.684 8.008-.381 1.478-1.495 2.64-2.907 3.032-1.063.297-3.205.47-5.35.571l-.755.033c-2.13.086-4.134.105-4.935.11h-.734c-1.696-.01-8.785-.087-11.04-.714-1.418-.398-2.532-1.56-2.908-3.032-.6-2.34-.675-6.904-.684-8.008v-.49c.01-1.105.084-5.67.684-8.008.382-1.478 1.496-2.64 2.908-3.033C5.847.086 12.936.01 14.632 0h.734Zm-3.367 6.749v10.5l9-5.25-9-5.25Z"></path></svg><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M6.791 18.77a2.959 2.959 0 0 1-2.952 2.952 2.959 2.959 0 0 1-2.951-2.951 2.959 2.959 0 0 1 2.951-2.952h2.952v2.952Zm1.487 0a2.959 2.959 0 0 1 2.952-2.951 2.959 2.959 0 0 1 2.952 2.952v7.39a2.959 2.959 0 0 1-2.952 2.952 2.959 2.959 0 0 1-2.952-2.952v-7.39ZM11.23 6.792A2.959 2.959 0 0 1 8.278 3.84 2.959 2.959 0 0 1 11.23.888a2.959 2.959 0 0 1 2.952 2.951v2.952H11.23Zm0 1.487a2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.952H3.84A2.959 2.959 0 0 1 .887 11.23a2.959 2.959 0 0 1 2.951-2.952h7.391Zm11.98 2.952a2.959 2.959 0 0 1 2.951-2.952 2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.952H23.21V11.23Zm-1.488 0a2.959 2.959 0 0 1-2.951 2.952 2.959 2.959 0 0 1-2.952-2.952V3.84A2.959 2.959 0 0 1 18.771.887a2.959 2.959 0 0 1 2.951 2.951v7.391Zm-2.951 11.98a2.959 2.959 0 0 1 2.951 2.951 2.959 2.959 0 0 1-2.951 2.952 2.959 2.959 0 0 1-2.952-2.952V23.21h2.952Zm0-1.488a2.959 2.959 0 0 1-2.952-2.951 2.959 2.959 0 0 1 2.952-2.952h7.39a2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.951h-7.39Z"></path></svg><svg width="28" height="30" viewBox="0 0 28 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M22.48 4.286H5.195c-.845 0-1.52.724-1.52 1.568v18.579c0 .844.675 1.568 1.52 1.568h17.283c.845 0 1.52-.724 1.52-1.568V5.854c0-.844-.675-1.568-1.52-1.568Z"></path><path d="M6.233 12.156h3.081v10.756H6.233V12.156Zm1.57-5.315c.988 0 1.802.875 1.802 1.938s-.814 1.939-1.803 1.939C6.814 10.718 6 9.842 6 8.779c0-1.063.814-1.938 1.802-1.938Zm3.488 5.315h2.965v1.439h.058c.407-.876 1.453-1.751 2.965-1.751 3.14 0 3.721 2.25 3.721 5.127v5.879h-3.081v-5.253c0-1.25 0-2.877-1.628-2.877s-1.86 1.376-1.86 2.752v5.315h-3.082v-10.63h-.058Z" fill="#000"></path></svg><svg width="34" height="28" viewBox="0 0 34 28" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M26.863 16.567c.748 0 1.347-.636 1.347-1.347 0-.748-.599-1.347-1.347-1.347s-1.347.599-1.347 1.347.599 1.347 1.347 1.347Zm-6.639 0c.749 0 1.347-.636 1.347-1.347 0-.748-.598-1.347-1.347-1.347-.748 0-1.346.599-1.346 1.347s.598 1.347 1.346 1.347Zm9.852 7.56a.52.52 0 0 0-.258.553c0 .074 0 .148.036.221.148.627.442 1.622.442 1.66 0 .11.037.184.037.257a.33.33 0 0 1-.331.332c-.074 0-.11-.037-.184-.074l-2.174-1.253c-.147-.074-.331-.147-.516-.147-.11 0-.22 0-.294.037-1.032.294-2.1.442-3.242.442-5.49 0-9.91-3.687-9.91-8.258 0-4.57 4.42-8.257 9.91-8.257 5.489 0 9.91 3.686 9.91 8.257 0 2.47-1.327 4.719-3.427 6.23ZM24.01 8.147a13.662 13.662 0 0 0-.418-.007c-6.262 0-11.41 4.29-11.41 9.757 0 .83.119 1.634.342 2.4h-.133c-1.33 0-2.659-.221-3.877-.553-.111-.037-.222-.037-.333-.037-.221 0-.443.074-.627.185L4.932 21.4a.525.525 0 0 1-.221.074.409.409 0 0 1-.406-.405c0-.11.036-.184.073-.294.037-.037.37-1.251.554-1.987 0-.074.037-.184.037-.258a.834.834 0 0 0-.332-.662C2.089 16.065.5 13.378.5 10.398.501 4.916 5.855.5 12.428.5 18.073.5 22.82 3.753 24.01 8.146Zm-7.73.627c.859 0 1.54-.716 1.54-1.54 0-.858-.681-1.539-1.54-1.539-.86 0-1.54.68-1.54 1.54 0 .859.68 1.54 1.54 1.54Zm-7.89 0c.86 0 1.54-.716 1.54-1.54 0-.858-.68-1.539-1.54-1.539-.859 0-1.539.68-1.539 1.54 0 .859.68 1.54 1.54 1.54Z"></path></svg></div></div></div><div class="copyrightWrap_yPz7"><div class="copyright_AoBa">
      <p>
        Apache Cloudberry is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
      </p>
      <p>
        Copyright © 2025 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.</p>
      <p>
        Apache®, the names of Apache projects, and the feather logo are either registered trademarks or trademarks of the Apache Software Foundation in the United States and/or other countries.
      </p>
      </div></div></div></div>
</body>
</html>